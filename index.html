<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="爱信息 爱数学 爱吃的萌新QAQ QQ:1814291128">
<meta property="og:type" content="website">
<meta property="og:title" content="小明的阁楼">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="小明的阁楼">
<meta property="og:description" content="爱信息 爱数学 爱吃的萌新QAQ QQ:1814291128">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小明的阁楼">
<meta name="twitter:description" content="爱信息 爱数学 爱吃的萌新QAQ QQ:1814291128">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>小明的阁楼</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小明的阁楼</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">故事再美  结局还是再见</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/08/错误/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/08/错误/" itemprop="url">错误</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-08T21:24:28+08:00">
                2018-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>鉴于省选第一轮已经滚粗了。。<br>我把我犯过的错误及对应的题目记下来，以警示自己。</p>
<p>！！：不容易在调试时发现<br>考试前一定要保持清醒&amp;充足睡眠<br>平时训练一定要保证清醒&amp;充足睡眠</p>
<p>三明治等含有鸡蛋或火腿的食物不要吃！（沙门氏菌）</p>
<p>学会静态+人眼（用脑子）查错！！<br>明明没有改它，为什么它变了？？！！越界了！！检查循环变量！！</p>
<p>对拍要试试极限数据看看是否超时</p>
<p>交上去一个优秀的暴力（最优化剪枝</p>
<p>浮躁，是人生中最大的错误。</p>
<p>再看漫画或者打游戏就要变小狗了ww<br>隔膜打的多，题目全tm看错！</p>
<p>不能急，冲动的时候什么都做不了。去洗把脸吧！</p>
<p>1) 多测没有清空应当清空的数组或变量（包括某些输入的数组）！！</p>
<ul>
<li>luogu4382 劈配</li>
<li>luogu2055 [ZJOI2009]假期的宿舍</li>
<li>poj3691 DNA repair</li>
<li>UVA10652 Board Wrapping</li>
<li>hdu6328（调了两天，zyb都没有看出的错误：多测时，n不同，线段树的形态也不同。要注意赋初值和清空时的区别（指分治每层的清空）。and 多测对拍n一直取相同值也是不好的。。）</li>
<li>hdu5396（线段树的build要注意对非叶子节点的初始化）</li>
</ul>
<p>2) 没有去掉调试时的输出（请用cerr!）</p>
<ul>
<li>luogu4365 秘密袭击</li>
</ul>
<p>3) 邻接表的nume出错（异或时没有成对出现或者第一个nume为0，请int nume=1;)</p>
<ul>
<li>luogu2765 魔术球问题</li>
<li>zkw费用流</li>
</ul>
<p>4) 变量名/数组名打错(i/j/x,n/m,x/y)(搞错对象)！！</p>
<ul>
<li>luogu2763 试题库问题</li>
<li>uva1515 pool construction</li>
<li>poj2947 Widget Factory</li>
<li>luogu2051 [AHOI2009]中国象棋</li>
<li>hdu3414 Tour Route</li>
<li>luogu1903 [国家集训队]数颜色</li>
<li>poj2985The k-th Largest Group</li>
<li>luogu3502 [POI2010]Hamsters</li>
<li>hiho1419  后缀数组四·重复旋律4</li>
<li>UVA11796 Dog Distance</li>
<li>luogu3157 [CQOI2011]动态逆序对</li>
<li>luogu3377 【模板】左偏树（可并堆）</li>
<li>zroi#363. 陈太阳与乐谱 *2！！</li>
<li>#444. 彩虹糖</li>
<li>ch5103 传纸条（被wyy<del>批判</del>教育了一番）</li>
</ul>
<p>5) 边界出错(n/n+1）！！</p>
<ul>
<li>luogu2447 [SDOI2010]外星千足虫</li>
</ul>
<p>6) 答案忘记更新或者在某处少更新！！修改操作少修改某些值！！</p>
<ul>
<li>luogu2447 [SDOI2010]外星千足虫</li>
<li>bzoj1453: [Wc]Dface双面棋盘</li>
</ul>
<p>7) 输出与题意不符（少复制了什么）！！</p>
<ul>
<li>poj2947 Widget Factory（少输出’.’）</li>
<li>bzoj1027 [JSOI2007]合金 （1输成-1）</li>
</ul>
<p>8) 没有初始化或初始化出错！！(dp等)</p>
<ul>
<li>luogu1070 道路游戏</li>
<li>luogu3502 [POI2010]Hamsters</li>
</ul>
<p>9) 多测没有把数据读完就输出</p>
<ul>
<li>hdu3414 Tour Route</li>
</ul>
<p>10) 做完一个就要break（循环忘记退出）！！</p>
<ul>
<li>hdu3414 Tour Route</li>
</ul>
<p>11) (空间）数组开小了（点数算少了/边数算少了）！！</p>
<ul>
<li>luogu1341 无序字母对</li>
<li>luogu2055 [ZJOI2009]假期的宿舍</li>
<li>luogu1345 [USACO5.4]奶牛的电信Telecowmunication</li>
<li>luogu3502 [POI2010]Hamsters</li>
<li>luogu2463 [SDOI2008]Sandy的卡片</li>
<li>luogu2657 [SCOI2009]windy数</li>
<li>正睿2018暑期集训AB班刷题营Day2 B. 配对</li>
<li>#378. 【2018普转提day19专题】打架</li>
<li>ch5102 Mobile Service</li>
<li>hdu5634 Rikka with Phi（zyb的教导：因为数组越界后会发生什么谁也不知道啊。。wa,tle,red都有可能。。zyf也因为数组开小t了。。）</li>
<li>bzoj3123（主席树启发式合并，双log啊，启发式合并空间都要多一个log，因为不能回收利用）</li>
<li>csa online xormax trie合并（动态开点至少要2logn，能开3logn更好;zyb:造极限数据输出tot）</li>
<li>poj3171（线段树对应的范围要看好了）</li>
</ul>
<p>12) 输入时出错（出现0之类的，读错，多度，少读）！！</p>
<ul>
<li>luogu1346 电车</li>
</ul>
<p>13) 爆int爆int爆int,类型出错，忘记强制类型转换,LL写成int（int×int爆int）！！</p>
<ul>
<li>luogu1265 公路修建</li>
<li>bzoj4765 普通计算姬</li>
<li>UVA10368 Euclid’s Game（没有数据范围。）</li>
<li>正睿2018暑期集训AB班刷题营Day5 A. 友谊巨轮</li>
<li>bzoj2115 [Wc2011] Xor</li>
<li>luogu3066 [Usaco2012 Dec]Running Away From the Barn</li>
<li>南外校内18-10-16 a</li>
<li>南外校内18-10-23 c（前面改过的LL后面相应的没改）</li>
<li>bzoj2124: 等差子序列（所有和hash相关的量都要用ll！！）</li>
<li>hdu4348 to the moon（要LL！）</li>
<li>bzoj4310</li>
<li>hdu5306</li>
<li>bzoj4355</li>
<li>poj1180</li>
</ul>
<p>14) 程序的顺序出错（逻辑顺序）或者逻辑错误（经常性的错误，不过没有记录，大概是认为和题目有关，实际上是思维严谨性的问题，感性理解之后要严谨的证明）</p>
<ul>
<li>luogu1484 种树</li>
<li>#109. 【17 提高 7】当那一天来临</li>
<li>bzoj2124: 等差子序列（变量名打反）</li>
<li>bzoj4892 dna</li>
<li>Gym 101194F</li>
<li>bzoj3277（长代码就容易出现逻辑错误，请静下心来肉眼查错。错误会比较多，在对拍前先查明显的错误，如k&lt;&lt;=1写成++k..）</li>
<li>gym101955B</li>
<li>bzoj4310</li>
</ul>
<p>15) 下标出现负数/下标越界</p>
<ul>
<li>bzoj4765 普通计算姬</li>
<li>bzoj2124: 等差子序列</li>
</ul>
<p>16) 题目分析有误</p>
<ul>
<li>luogu2022 有趣的数</li>
</ul>
<p>17) max/min设置的有误</p>
<ul>
<li>luogu3369 【模板】普通平衡树</li>
</ul>
<p>18) eps设置太小会t</p>
<p>19) (apio2018)使用set查找时尽量不要用pair，对双关键字排序要注意</p>
<p>20) 数组下标打反</p>
<ul>
<li>bzoj1027 [JSOI2007]合金</li>
</ul>
<p>21) 程序改一半忘了</p>
<ul>
<li>bzoj1027 [JSOI2007]合金</li>
</ul>
<p>22) 对拍忘记srand</p>
<ul>
<li>hiho1419  后缀数组四·重复旋律4</li>
</ul>
<p>23) 未定义行为</p>
<ul>
<li>UVA1342 That Nice Euler Circuit（a[i]=point(read(),read())其中读入的顺序可能会反过来）</li>
</ul>
<p>24) 四舍五入得到-0，正确的姿势是int(x+0.5)。保留1位小数则是printf(“%.1f”,int(a<em>10+0.5)</em>1.0/10);</p>
<p>25) 没有取模！！</p>
<ul>
<li>正睿2018暑期集训AB班刷题营Day2 B. 配对</li>
<li>#108. 【17 提高 7】强军战歌</li>
</ul>
<p>26) (a+=b)%=c 而不是 (a+=b)%c;</p>
<ul>
<li><p>27) long long用%d输出</p>
</li>
<li>zroi #261. 萌新拆塔（cjq也是！233）</li>
</ul>
<p>28) 模拟赛中犯的错</p>
<ul>
<li>没有把所有复制的地方都改正。</li>
<li>用错了变量</li>
<li>dijk没改成小根堆！！好几次了啊！</li>
</ul>
<p>29) double写成int</p>
<ul>
<li>luogu4525 【模板】自适应辛普森法1</li>
</ul>
<p>30) 求割边用fa</p>
<ul>
<li>#359. 【2018普转提day18专题】嘤嘤</li>
</ul>
<p>31) 1到n的最短路上的边用ds[x]+e[i].f+dt[y]==ds[n]判断，从s或t向外延伸都是错的</p>
<ul>
<li>#359. 【2018普转提day18专题】嘤嘤</li>
</ul>
<p>32) memset(a,0x3f,sizeof(a))如果a是指针，sizeof(a)只有8个字节</p>
<ul>
<li>#359. 【2018普转提day18专题】嘤嘤</li>
</ul>
<p>33) 数组只开大1而越界了。。</p>
<p>34) 树上dp时sz没有和背包大小取min</p>
<ul>
<li>南外校内18-10-16 a</li>
</ul>
<p>35) 以为没爆int实际爆了，三个int相加爆了，以为类型转换了实际没有转。。</p>
<ul>
<li>南外校内18-10-16 a</li>
</ul>
<p>36) 递归变量和全局变量重复</p>
<ul>
<li>#423. 锅锅</li>
</ul>
<p>37) 使用stl容器前没有判是否为空（如set）</p>
<ul>
<li>#467. 数的距离</li>
</ul>
<p>38) 涉及图的题目，要注意重边和自环！！</p>
<ul>
<li>luoguP1850 换教室</li>
</ul>
<p>39) 注意运输符的结合律，连等的时候要注意变量的改变！</p>
<ul>
<li>#322. 【Jiangsu Training Contest 5】Graph</li>
</ul>
<p>40) 输入scanf(“%d”,a+i)写成scanf(“%d”,a+1)</p>
<ul>
<li>bzoj3585╱luogu4137 mex</li>
</ul>
<p>41) add_ans和ass_ans搞混</p>
<ul>
<li>csa Min Max Sum</li>
</ul>
<p>42) bzoj3123专属错误：T是数据类型不是数据组数！！</p>
<p>43) 题意理解错误/题目读错</p>
<ul>
<li>bzoj3277（本质相同的子串算多次！！）</li>
<li>usaco2018-12ptA rounded down to the nearest integer（向下取整，不是round）</li>
</ul>
<p>44) 预处理使用n，但n还没有读入（应该用N）</p>
<ul>
<li>gym101955B</li>
</ul>
<p>45) 动态数据结构在多测时尽量不要用memset，容易mle（好像不用的空间就不算）</p>
<ul>
<li>hdu4348 to the moon</li>
</ul>
<p>46) 死于未定义行为（而且很难调）（调用顺序，有符号溢出在玄学的优化下gg）</p>
<ul>
<li>gym102028 H</li>
</ul>
<p>47) priority_queue没有改成小根堆</p>
<ul>
<li>dijk</li>
<li>19-1-1 B</li>
</ul>
<p>48) 滚动数组每层要清空！！（或者确保每个值都被重新赋值了）</p>
<ul>
<li>poj2411</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/16/待填的坑/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/16/待填的坑/" itemprop="url">待填的坑</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-16T19:05:39+08:00">
                2018-06-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.块状数组/块状链表<br>2.上下界网络流<br>3.fft/ntt<br>4.dp斜率优化/四边形不等式/决策单调性<br>5.数论（反演/筛，置换）<br>6.图论（tarjan，仙人掌（圆方树））<br>7.数据结构（线段树合并和分裂，主席树，点分治，平衡树，二叉堆，cdq分治，整体二分，lct，k-d tree）<br>8.容斥<br>9.高精度除法</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/28/技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/技巧/" itemprop="url">技巧</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-28T19:27:55+08:00">
                2018-04-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>内啡肽：冷静作用<br>促进内啡肽分泌的方式：运动，冥想，深呼吸，笑</p>
<p>多巴胺：预期奖励<br>短期大量释放多巴胺，让我们更追求短期快感，更没耐心。<br>更多的多巴胺或提高阈值，导致更难获得快乐。<br>保持平常心，减少情绪波动，降低多巴胺分泌。</p>
<p>差不多退役了<br>算法竞赛教会我什么呢<br>多年之后还能影响到我的估计只有思维上多出的一丝敏捷（这都没有就啥都没有了<br>吉老师线段树什么的怎么可能记得呢（亏我熬夜到一点去调代码，结果是思维方式有问题<br>（把tag放在一起考虑，<tag1,tag2,...>，合并起来也方便</tag1,tag2,...></p>
<p>要是有机会去wc的话，接下来一段时间的目标是数学和dp<br>有机会了（这是你颓废那么多天的结果吗。。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/04/28/技巧/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/20/【学习笔记】分块&莫队/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/20/【学习笔记】分块&莫队/" itemprop="url">【学习笔记】分块&莫队</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-20T12:05:55+08:00">
                2019-08-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="分块-amp-莫队"><a href="#分块-amp-莫队" class="headerlink" title="分块&amp;莫队"></a>分块&amp;莫队</h2><h3 id="分块："><a href="#分块：" class="headerlink" title="分块："></a>分块：</h3><p>如果我们把每m个元素分为一块，共有n/m块，每次区间加的操作会涉及O(n/m)个整块，以及区间两侧两个不完整的块中至多2m个元素。每次操作的复杂度是O(n/m)+O(m)，根据均值不等式，当m取√n时总复杂度最低。(hzwer)</p>
<p>分块：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">	bl[i]=(i<span class="number">-1</span>)/blk+<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line">nb=bl[n];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=nb;++i)&#123;</div><div class="line">	lblk[i]=(i<span class="number">-1</span>)*blk+<span class="number">1</span>;</div><div class="line">	rblk[i]=i*blk;</div><div class="line">&#125;</div><div class="line">rblk[nb]=n;</div></pre></td></tr></table></figure></p>
<p>王室联邦分块：<br>用于树上莫队<br>用法待学<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,b;</div><div class="line"><span class="keyword">int</span> x,y;</div><div class="line"><span class="keyword">int</span> nume,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt;</div><div class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x]&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> k,bl[N],ct[N];</div><div class="line"><span class="comment">//vector&lt;int&gt; s[N];</span></div><div class="line"><span class="keyword">int</span> num,st[N];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> tmp=num;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">		<span class="keyword">int</span> to=e[i].to;</div><div class="line">		<span class="keyword">if</span>(to!=fa)&#123;</div><div class="line">			dfs(to,x);</div><div class="line">			<span class="keyword">if</span>(num-tmp&gt;=b)&#123;</div><div class="line">				++k;</div><div class="line">				ct[k]=x;</div><div class="line">				<span class="keyword">while</span>(num&gt;tmp)&#123;</div><div class="line">					<span class="comment">//s[k].pb(st[num]);</span></div><div class="line">					bl[st[num]]=k;</div><div class="line">					--num;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	st[++num]=x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;b=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">		x=io;y=io;</div><div class="line">		add_edge(x,y);</div><div class="line">		add_edge(y,x);</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">	<span class="comment">//if(!num)	ct[++num]=1; </span></div><div class="line">	<span class="keyword">while</span>(num&gt;<span class="number">0</span>)&#123;</div><div class="line">		<span class="comment">//s[k].pb(st[num]);</span></div><div class="line">		bl[st[num]]=k;</div><div class="line">		--num;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,k);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,bl[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,ct[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="莫队："><a href="#莫队：" class="headerlink" title="莫队："></a>莫队：</h3><p>普通莫队、带修改莫队、树上莫队、回滚莫队（见全网最详细、最深的四类莫队算法讲解）<br>普通莫队：<br>先按左指针所在块升序，同一块按右指针升序。<br>复杂度：设块长m，共n/m块，左指针移动q·m次，右指针移动n·n/m次，m取n/sqrt(q)时，为n·sqrt(q)</p>
<p>莫队：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> curl=<span class="number">1</span>,curr=<span class="number">0</span>; </div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qn;++i)&#123;</div><div class="line">	<span class="keyword">while</span>(curl&lt;b[i].l)&#123;</div><div class="line">		remove(curl);++curl;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(curl&gt;b[i].l)&#123;</div><div class="line">		--curl;add(curl);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(curr&lt;b[i].r)&#123;</div><div class="line">		++curr;add(curr);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(curr&gt;b[i].r)&#123;</div><div class="line">		remove(curr);--curr;</div><div class="line">	&#125;</div><div class="line">	solve(i);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>把块大小blk设成定值不易出错，方便调块大小卡常。</p>
<p>luogu4396 [AHOI2013]作业<br>莫队+分块：在区间上莫队，在值域上分块。莫队的转移是O(1)。每个询问求答案是用分块，复杂度根号，查询的总复杂度为q根号n。总复杂度是O(n·sqrt(q)+q·sqrt(n))<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100000</span>+<span class="number">8</span>,QN=<span class="number">1000000</span>+<span class="number">8</span>,NB=<span class="number">350</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> blk=<span class="number">300</span>;</div><div class="line"><span class="keyword">int</span> n,qn;</div><div class="line"><span class="keyword">int</span> a[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ques</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> l,r,a,b,id;</div><div class="line">&#125;b[QN];</div><div class="line"><span class="keyword">int</span> bl[N],nb,lblk[NB],rblk[NB];<span class="comment">//值域也是1到n，共用一个bl </span></div><div class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> ques &amp;a,<span class="keyword">const</span> ques &amp;b)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(bl[a.l]!=bl[b.l])	<span class="keyword">return</span> bl[a.l]&lt;bl[b.l];</div><div class="line">	<span class="keyword">return</span> a.r&lt;b.r;</div><div class="line">&#125;	</div><div class="line"><span class="keyword">int</span> cnt[N],num1[NB],num2[NB];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	++cnt[a[x]];</div><div class="line">	++num1[bl[a[x]]];</div><div class="line">	<span class="keyword">if</span>(cnt[a[x]]==<span class="number">1</span>)	++num2[bl[a[x]]];</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	--cnt[a[x]];</div><div class="line">	--num1[bl[a[x]]];</div><div class="line">	<span class="keyword">if</span>(cnt[a[x]]==<span class="number">0</span>)	--num2[bl[a[x]]];</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> ans1[QN],ans2[QN];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans1=<span class="number">0</span>,ans2=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> l=b[x].a,r=b[x].b;</div><div class="line">	<span class="keyword">if</span>(bl[l]==bl[r])&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i)&#123;</div><div class="line">			ans1+=cnt[i];ans2+=(cnt[i]&gt;<span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=bl[l]+<span class="number">1</span>;i&lt;=bl[r]<span class="number">-1</span>;++i)&#123;</div><div class="line">			ans1+=num1[i];ans2+=num2[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=rblk[bl[l]];++i)&#123;</div><div class="line">			ans1+=cnt[i];ans2+=(cnt[i]&gt;<span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=lblk[bl[r]];i&lt;=r;++i)&#123;</div><div class="line">			ans1+=cnt[i];ans2+=(cnt[i]&gt;<span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	::ans1[b[x].id]=ans1;</div><div class="line">	::ans2[b[x].id]=ans2;</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> curl=<span class="number">1</span>,curr=<span class="number">0</span>; </div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qn;++i)&#123;</div><div class="line">		<span class="keyword">while</span>(curl&lt;b[i].l)&#123;</div><div class="line">			remove(curl);++curl;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">while</span>(curl&gt;b[i].l)&#123;</div><div class="line">			--curl;add(curl);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">while</span>(curr&lt;b[i].r)&#123;</div><div class="line">			++curr;add(curr);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">while</span>(curr&gt;b[i].r)&#123;</div><div class="line">			remove(curr);--curr;</div><div class="line">		&#125;</div><div class="line">		solve(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qn;++i)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,ans1[i],ans2[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;qn=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		a[i]=io;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qn;++i)&#123;</div><div class="line">		b[i].l=io;b[i].r=io;b[i].a=io;b[i].b=io;</div><div class="line">		b[i].id=i;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		bl[i]=(i<span class="number">-1</span>)/blk+<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	nb=bl[n];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=nb;++i)&#123;</div><div class="line">		lblk[i]=(i<span class="number">-1</span>)*blk+<span class="number">1</span>;</div><div class="line">		rblk[i]=i*blk;</div><div class="line">	&#125;</div><div class="line">	rblk[nb]=n;</div><div class="line">	</div><div class="line">	sort(b+<span class="number">1</span>,b+qn+<span class="number">1</span>,cmp);</div><div class="line">	MAIN();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>luogu1903 [国家集训队]数颜色/维护队列<br>带修改莫队：多了一个时间轴。排序第一关键字是左端点所在块编号，第二关键字是右端点所在块编号，第三关键字是时间。左指针移动的复杂度为q·n，右指针的复杂度为n/m·n，时间轴的指针的复杂度为n/m·n/m·q，n和q同阶的时候，m取n^(2/3)时最优。比较需要调块大小。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;cstdio&gt;</div><div class="line">#include&lt;cstring&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;vector&gt;</div><div class="line">#include&lt;set&gt;</div><div class="line">#include&lt;map&gt;</div><div class="line">#include&lt;bitset&gt;</div><div class="line">#define mp make_pair</div><div class="line">#define pb push_back</div><div class="line">#define fi first</div><div class="line">#define se second</div><div class="line">#define IL inline</div><div class="line">#define filein(s) freopen(s,&quot;r&quot;,stdin);</div><div class="line">#define fileout(s) freopen(s,&quot;w&quot;,stdout);</div><div class="line">using namespace std;</div><div class="line">typedef long long LL;</div><div class="line">typedef unsigned int U;</div><div class="line">typedef unsigned long long LLU;</div><div class="line">typedef pair&lt;int,int&gt; PII;</div><div class="line">typedef long double LD;</div><div class="line">IL LL read()</div><div class="line">&#123;</div><div class="line">	LL x=0,f=1;char ch=getchar();</div><div class="line">	while(ch&lt;&apos;0&apos;||ch&gt;&apos;9&apos;)&#123;if(ch==&apos;-&apos;)f=-1;ch=getchar();&#125;</div><div class="line">	while(ch&gt;=&apos;0&apos;&amp;&amp;ch&lt;=&apos;9&apos;)&#123;x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^48);ch=getchar();&#125;</div><div class="line">	return x*f;</div><div class="line">&#125;</div><div class="line">#define io read()</div><div class="line">const int N=133333+8,QN=133333+8,VAL=1000000+8;</div><div class="line">const int blk=6000;</div><div class="line">int n,qn,qn1,qn2;</div><div class="line">int a[N],c[N];</div><div class="line">int bl[N];</div><div class="line">struct ques1&#123;</div><div class="line">	int l,r,id,cur;</div><div class="line">&#125;b1[QN];</div><div class="line">struct ques2&#123;</div><div class="line">	int pos,a,b;</div><div class="line">&#125;b2[QN];</div><div class="line">IL bool cmp(const ques1 &amp;a,const ques1 &amp;b)</div><div class="line">&#123;</div><div class="line">	if(bl[a.l]!=bl[b.l])	return a.l&lt;b.l;</div><div class="line">	if(bl[a.r]!=bl[b.r])	return a.r&lt;b.r;</div><div class="line">	return a.cur&lt;b.cur;</div><div class="line">&#125;</div><div class="line">int curl=1,curr=0,cur=0;</div><div class="line">int tot=0,cnt[VAL];</div><div class="line">IL void add(int x)</div><div class="line">&#123;</div><div class="line">	++cnt[x];</div><div class="line">	if(cnt[x]==1)	++tot;</div><div class="line">&#125;</div><div class="line">IL void remove(int x)</div><div class="line">&#123;</div><div class="line">	--cnt[x];</div><div class="line">	if(cnt[x]==0)	--tot;</div><div class="line">&#125; </div><div class="line">IL void change(int pos,int x)</div><div class="line">&#123;</div><div class="line">	if(curl&lt;=pos&amp;&amp;pos&lt;=curr)&#123;</div><div class="line">		remove(a[pos]);</div><div class="line">		add(x);</div><div class="line">	&#125;</div><div class="line">	a[pos]=x;</div><div class="line">&#125;</div><div class="line">int ans[QN];</div><div class="line">IL void MAIN()</div><div class="line">&#123;</div><div class="line">	for(int i=1;i&lt;=qn1;++i)&#123;</div><div class="line">		while(cur&lt;b1[i].cur)&#123;</div><div class="line">			++cur;</div><div class="line">			change(b2[cur].pos,b2[cur].b);</div><div class="line">		&#125;</div><div class="line">		while(cur&gt;b1[i].cur)&#123;</div><div class="line">			change(b2[cur].pos,b2[cur].a);</div><div class="line">			--cur;</div><div class="line">		&#125;</div><div class="line">		while(curl&lt;b1[i].l)&#123;</div><div class="line">			remove(a[curl]);++curl;</div><div class="line">		&#125;</div><div class="line">		while(curl&gt;b1[i].l)&#123;</div><div class="line">			--curl;add(a[curl]);</div><div class="line">		&#125;</div><div class="line">		while(curr&lt;b1[i].r)&#123;</div><div class="line">			++curr;add(a[curr]);</div><div class="line">		&#125;	</div><div class="line">		while(curr&gt;b1[i].r)&#123;</div><div class="line">			remove(a[curr]);--curr;</div><div class="line">		&#125;</div><div class="line">		ans[b1[i].id]=tot;</div><div class="line">	&#125;</div><div class="line">	for(int i=1;i&lt;=qn1;++i)&#123;</div><div class="line">		printf(&quot;%d\n&quot;,ans[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	n=io;qn=io;</div><div class="line">	for(int i=1;i&lt;=n;++i)&#123;</div><div class="line">		a[i]=c[i]=io;</div><div class="line">		bl[i]=(i-1)/blk+1;</div><div class="line">	&#125;</div><div class="line">	for(int i=1;i&lt;=qn;++i)&#123;</div><div class="line">		char ch;</div><div class="line">		scanf(&quot;%c&quot;,&amp;ch);</div><div class="line">		if(ch==&apos;Q&apos;)&#123;</div><div class="line">			++qn1;</div><div class="line">			b1[qn1].l=io;b1[qn1].r=io;</div><div class="line">			b1[qn1].id=qn1;b1[qn1].cur=qn2;</div><div class="line">		&#125;</div><div class="line">		else&#123;</div><div class="line">			++qn2;</div><div class="line">			b2[qn2].pos=io;</div><div class="line">			b2[qn2].a=c[b2[qn2].pos];</div><div class="line">			c[b2[qn2].pos]=b2[qn2].b=io;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	sort(b1+1,b1+qn1+1,cmp);</div><div class="line">	MAIN();</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>atcoder1219 歴史の研究<br>回滚莫队：用来处理不适合添加或者删除的情况。对于处于同一块的左指针，每次移动之前将左指针放在下一个块的第一个位置，移动之后再把左指针放到下一个块的第一个位置。这样可以使得问题只有添加没有删除（或者删除变的可以处理）。复杂度同普通莫队。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line">#include&lt;bits/stdc++.h&gt;</div><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;cstdio&gt;</div><div class="line">#include&lt;cstring&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;vector&gt;</div><div class="line">#include&lt;set&gt;</div><div class="line">#include&lt;map&gt;</div><div class="line">#include&lt;bitset&gt;</div><div class="line">#define mp make_pair</div><div class="line">#define pb push_back</div><div class="line">#define fi first</div><div class="line">#define se second</div><div class="line">#define IL inline</div><div class="line">#define filein(s) freopen(s,&quot;r&quot;,stdin);</div><div class="line">#define fileout(s) freopen(s,&quot;w&quot;,stdout);</div><div class="line">using namespace std;</div><div class="line">typedef long long LL;</div><div class="line">typedef unsigned int U;</div><div class="line">typedef unsigned long long LLU;</div><div class="line">typedef pair&lt;int,int&gt; PII;</div><div class="line">typedef long double LD;</div><div class="line">IL LL read()</div><div class="line">&#123;</div><div class="line">	LL x=0,f=1;char ch=getchar();</div><div class="line">	while(ch&lt;&apos;0&apos;||ch&gt;&apos;9&apos;)&#123;if(ch==&apos;-&apos;)f=-1;ch=getchar();&#125;</div><div class="line">	while(ch&gt;=&apos;0&apos;&amp;&amp;ch&lt;=&apos;9&apos;)&#123;x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^48);ch=getchar();&#125;</div><div class="line">	return x*f;</div><div class="line">&#125;</div><div class="line">#define io read()</div><div class="line">const int N=100000+8,QN=100000+8,NB=350;</div><div class="line">const int blk=300;</div><div class="line">int n,qn;</div><div class="line">int tot,ori[N],a[N];</div><div class="line">struct ques&#123;</div><div class="line">	int l,r,id;</div><div class="line">&#125;b[QN];</div><div class="line">int nb,bl[N],lblk[NB],rblk[NB];</div><div class="line">IL bool cmp(const ques &amp;a,const ques &amp;b)</div><div class="line">&#123;</div><div class="line">	if(bl[a.l]!=bl[b.l])	return bl[a.l]&lt;bl[b.l];</div><div class="line">	return a.r&lt;b.r;	</div><div class="line">&#125;</div><div class="line">int cnt[N];</div><div class="line">LL ans[QN];</div><div class="line">IL void MAIN()</div><div class="line">&#123;</div><div class="line">	int curl=0,curr=0;</div><div class="line">	LL ans=0,tmp=0;</div><div class="line">	for(int i=1;i&lt;=qn;++i)&#123;</div><div class="line">		int l=b[i].l,r=b[i].r;</div><div class="line">		if(bl[l]!=bl[b[i-1].l])&#123;</div><div class="line">			curl=rblk[bl[l]]+1;</div><div class="line">			curr=rblk[bl[l]];</div><div class="line">			tmp=0;</div><div class="line">			memset(cnt,0,sizeof(cnt));</div><div class="line">		&#125;</div><div class="line">		if(bl[l]==bl[r])&#123;</div><div class="line">			ans=0;</div><div class="line">			for(int i=l;i&lt;=r;++i)&#123;</div><div class="line">				++cnt[a[i]];</div><div class="line">				ans=max(ans,1ll*cnt[a[i]]*ori[a[i]]);</div><div class="line">			&#125;</div><div class="line">			for(int i=l;i&lt;=r;++i)&#123;</div><div class="line">				--cnt[a[i]];</div><div class="line">			&#125;</div><div class="line">			::ans[b[i].id]=ans;</div><div class="line">			continue;</div><div class="line">		&#125;</div><div class="line">		while(curr&lt;r)&#123;</div><div class="line">			++curr;++cnt[a[curr]];</div><div class="line">			tmp=max(tmp,1ll*cnt[a[curr]]*ori[a[curr]]);</div><div class="line">		&#125;</div><div class="line">		ans=tmp;</div><div class="line">		while(curl&gt;l)&#123;</div><div class="line">			--curl;++cnt[a[curl]];</div><div class="line">			ans=max(ans,1ll*cnt[a[curl]]*ori[a[curl]]);</div><div class="line">		&#125;</div><div class="line">		while(curl&lt;rblk[bl[l]]+1)&#123;</div><div class="line">			--cnt[a[curl]];++curl;</div><div class="line">		&#125;</div><div class="line">		::ans[b[i].id]=ans;</div><div class="line">	&#125;</div><div class="line">	for(int i=1;i&lt;=qn;++i)&#123;</div><div class="line">		printf(&quot;%lld\n&quot;,::ans[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	n=io;qn=io;</div><div class="line">	for(int i=1;i&lt;=n;++i)&#123;</div><div class="line">		ori[i]=a[i]=io;</div><div class="line">	&#125;</div><div class="line">	sort(ori+1,ori+n+1);</div><div class="line">	tot=unique(ori+1,ori+n+1)-ori-1;</div><div class="line">	for(int i=1;i&lt;=n;++i)&#123;</div><div class="line">		a[i]=lower_bound(ori+1,ori+tot+1,a[i])-ori;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	for(int i=1;i&lt;=qn;++i)&#123;</div><div class="line">		b[i].l=io;b[i].r=io;</div><div class="line">		b[i].id=i;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	for(int i=1;i&lt;=n;++i)&#123;</div><div class="line">		bl[i]=(i-1)/blk+1;	</div><div class="line">	&#125;</div><div class="line">	nb=bl[n];</div><div class="line">	for(int i=1;i&lt;=nb;++i)&#123;</div><div class="line">		lblk[i]=(i-1)*blk+1;</div><div class="line">		rblk[i]=i*blk;</div><div class="line">	&#125;</div><div class="line">	rblk[nb]=n;</div><div class="line">	</div><div class="line">	sort(b+1,b+qn+1,cmp);</div><div class="line">	MAIN();</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>区间众数<br>离线：回滚莫队 时间n·sqrt(q) 空间n<br>在线：分块 时间n·sqrt(q) 空间n</p>
<p>luogu5048 [Ynoi2019模拟赛]Yuno loves sqrt technology III<br>区间众数 众数的次数 在线<br>先离散化数据，将每个数据都放到对应的桶里(vector)，并记下排名。<br>再预处理一个f[i][j]表示第i个块到第j个块中的众数是多少，同时也可以记下众数是什么。<br>对于每一个[l,r]，ans开始是f[bl[l]+1][bl[r]-1]为中间块的众数。<br>对于左边的数字，在其对应的vector中找从他开始往后ans个数的位置是否&lt;=r(首先要保证有后ans个数)，如果有则++ans<br>对于右边的数字，在其对应的vector中找从他开始往前ans个数的位置是否&gt;=l(首先要保证有前ans个数)，如果有则++ans<br>复杂度：ans自增最多blk次，因为每次更新的数的位置要跨越[bl[l]+1][bl[r]-1]，这样就是两边区间的数的个数。预处理复杂度为n·n/m，每次查询复杂度为m，总复杂度n·n/m+q·m<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">500000</span>+<span class="number">8</span>,NB=<span class="number">750</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> blk=<span class="number">700</span>;</div><div class="line"><span class="keyword">int</span> n,qn,nb;</div><div class="line"><span class="keyword">int</span> ori[N],tot,a[N];</div><div class="line"><span class="keyword">int</span> bl[N],lblk[N],rblk[N];</div><div class="line"><span class="keyword">int</span> f[NB][NB];</div><div class="line"><span class="keyword">int</span> pos[N];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; set_pos[N];</div><div class="line"><span class="keyword">int</span> cnt[N];</div><div class="line"><span class="keyword">int</span> l,r,lstans;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(qn--)&#123;</div><div class="line">		l=io^lstans;r=io^lstans;</div><div class="line">		<span class="keyword">if</span>(bl[l]+<span class="number">1</span>&lt;=bl[r]<span class="number">-1</span>)	ans=f[bl[l]+<span class="number">1</span>][bl[r]<span class="number">-1</span>];</div><div class="line">		<span class="keyword">else</span>	ans=<span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(bl[l]==bl[r])&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i)&#123;</div><div class="line">				<span class="keyword">while</span>(pos[i]+ans&lt;set_pos[a[i]].size()&amp;&amp;set_pos[a[i]][pos[i]+ans]&lt;=r)&#123;</div><div class="line">					++ans;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125; </div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=rblk[bl[l]];++i)&#123;</div><div class="line">				<span class="keyword">while</span>(pos[i]+ans&lt;set_pos[a[i]].size()&amp;&amp;set_pos[a[i]][pos[i]+ans]&lt;=r)&#123;</div><div class="line">					++ans;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=lblk[bl[r]];i&lt;=r;++i)&#123;</div><div class="line">				<span class="keyword">while</span>(pos[i]-ans&gt;=<span class="number">0</span>&amp;&amp;set_pos[a[i]][pos[i]-ans]&gt;=l)&#123;</div><div class="line">					++ans;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">		lstans=ans; </div><div class="line">	&#125;	</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;qn=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		a[i]=ori[i]=io;</div><div class="line">	&#125;</div><div class="line">	sort(ori+<span class="number">1</span>,ori+n+<span class="number">1</span>);</div><div class="line">	tot=unique(ori+<span class="number">1</span>,ori+n+<span class="number">1</span>)-ori<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		a[i]=lower_bound(ori+<span class="number">1</span>,ori+tot+<span class="number">1</span>,a[i])-ori;</div><div class="line">		pos[i]=set_pos[a[i]].size();</div><div class="line">		set_pos[a[i]].pb(i);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		bl[i]=(i<span class="number">-1</span>)/blk+<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	nb=bl[n];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=nb;++i)&#123;</div><div class="line">		lblk[i]=blk*(i<span class="number">-1</span>)+<span class="number">1</span>;</div><div class="line">		rblk[i]=blk*i;</div><div class="line">	&#125;</div><div class="line">	rblk[nb]=n;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i+=blk)&#123;</div><div class="line">		<span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span>(cnt));</div><div class="line">		<span class="keyword">int</span> t=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;=n;++j)&#123;</div><div class="line">			++cnt[a[j]];</div><div class="line">			<span class="keyword">if</span>(cnt[a[j]]&gt;t)	t=cnt[a[j]];</div><div class="line">			<span class="keyword">if</span>(rblk[bl[j]]==j)&#123;</div><div class="line">				f[bl[i]][bl[j]]=t;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	MAIN();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/13/模板&复习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/13/模板&复习/" itemprop="url">模板&复习</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-13T23:00:37+08:00">
                2019-08-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>把编辑器/编译器调到舒服的状态（见考试安排）<br>学会用批处理和写对拍（见批处理）<br>学会随机化生成（见随机化）<br>学会离散化（这种最方便）<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">	a[i]=ori[i]=io;</div><div class="line">&#125;</div><div class="line">sort(ori+<span class="number">1</span>,ori+n+<span class="number">1</span>);</div><div class="line">tot=unique(ori+<span class="number">1</span>,ori+n+<span class="number">1</span>)-ori<span class="number">-1</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">	a[i]=lower_bound(ori+<span class="number">1</span>,ori+tot+<span class="number">1</span>,a[i])-ori;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>掌握c风格输入输出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">scanf：</div><div class="line">int -&gt; %d</div><div class="line">long long -&gt; %lld</div><div class="line">unsigned int -&gt; %u</div><div class="line">unsigned long long -&gt; %llu</div><div class="line">float -&gt; %f</div><div class="line">double -&gt; %lf</div><div class="line">long double -&gt; %Lf</div><div class="line">char -&gt; %c</div><div class="line">char a[] -&gt; %s</div><div class="line"></div><div class="line">printf：</div><div class="line">int -&gt; %d</div><div class="line">long long -&gt; %lld</div><div class="line">unsigned int -&gt; %u</div><div class="line">unsigned long long -&gt; %llu</div><div class="line">float -&gt; %f</div><div class="line">double -&gt; %f （和scanf不一样！）</div><div class="line">long double -&gt; %Lf</div><div class="line">char -&gt; %c</div><div class="line">char a[] -&gt; %s</div></pre></td></tr></table></figure></p>
<p>稳固代码风格：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">++i</div><div class="line">只有函数的大括号换行，其他不换行</div><div class="line">用c风格输入输出</div><div class="line">无论什么系统，使用快读</div><div class="line">尽量用局部变量</div><div class="line">规定范围的常量用对应变量的大写命名</div><div class="line">主体在MAIN()中处理，在main()中做预处理，较长的函数要分段</div><div class="line">部分分写在namespace里</div><div class="line">所有函数加IL(inline)</div></pre></td></tr></table></figure></p>
<p>附个模板：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="分块-amp-莫队"><a href="#分块-amp-莫队" class="headerlink" title="分块&amp;莫队"></a>分块&amp;莫队</h2><p>分块、莫队：暴力的加强版，思维难度小，代码量小，复杂度未必最优。（适合康复第一阶段训练）<br>（具体题目&amp;代码见【学习笔记】分块&amp;莫队）</p>
<h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><p>存图方式：<br>1、邻接矩阵<br>2、邻接表<br>nume=1为了方便找反向边，=-1则head要设为-1（小于0即可）<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> nume=<span class="number">1</span>,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">	<span class="keyword">int</span> to=e[i].to;</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="单元最短路径"><a href="#单元最短路径" class="headerlink" title="单元最短路径"></a>单元最短路径</h3><p>（spfa它死了）<br>dijkstra：要求边权都是非负数<br>1、稠密图（m和n^2同级别），复杂度n^2<br>2、稀疏图，堆优化，复杂度(m+n)logm（注意到logm和logn同级别）<br>3、边权较小，桶优化，时间复杂度(m+n·最大边权），空间复杂度（n·最大边权+m）<br>对于不同的条件，使用不同的方法找最小边权。</p>
<p>dijk基于贪心，只要一个点被选中标记之后，任何其他路径不会使它更优即可使用。<br>spfa则是使图中的每条边都满足三角形不等式（不满足则存在不合题意的环），即对于边(x,y,z)，cal(dp[x],z)&gt;dp[y]，其中cal代表某种运算。</p>
<p>堆优化dijk<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100000</span>+<span class="number">8</span>,M=<span class="number">200000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,m,s;</div><div class="line"><span class="keyword">int</span> x,y,z;</div><div class="line"><span class="keyword">int</span> nume=<span class="number">1</span>,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> dis[N];</div><div class="line"><span class="keyword">bool</span> vis[N];</div><div class="line">priority_queue&lt;PII,<span class="built_in">vector</span>&lt;PII&gt;,greater&lt;PII&gt; &gt;pq;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dijk</span><span class="params">()</span></span></div><div class="line">&#123;	</div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="comment">//memset(vis,0,sizeof(vis));</span></div><div class="line">	dis[s]=<span class="number">0</span>;</div><div class="line">	pq.push(mp(<span class="number">0</span>,s));</div><div class="line">	<span class="keyword">while</span>(!pq.empty())&#123;</div><div class="line">		<span class="keyword">int</span> x=pq.top().se;</div><div class="line">		pq.pop();</div><div class="line">		<span class="keyword">if</span>(vis[x])	<span class="keyword">continue</span>;</div><div class="line">		vis[x]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].to;</div><div class="line">			<span class="keyword">if</span>(dis[to]&gt;dis[x]+e[i].f)&#123;</div><div class="line">				dis[to]=dis[x]+e[i].f;</div><div class="line">				pq.push(mp(dis[to],to)); </div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,dis[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;m=io;s=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">		x=io;y=io;z=io;</div><div class="line">		add_edge(x,y,z);</div><div class="line">		<span class="comment">//add_edge(y,x,z);</span></div><div class="line">	&#125;</div><div class="line">	dijk();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>01bfs：边权为0或1的图求单源最短路<br>通过双端队列bfs，边权为0则从队头入队，边权为1从队尾入队。任意时刻保持队列的“两段性”和“单调性”<br>一个点最多入队两次，可以用vis判断（不用也是正确的）。复杂度n+m</p>
<p>luogu1948 [USACO08JAN]电话线Telephone Lines<br>二分答案后转化成01bfs<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000</span>+<span class="number">8</span>,P=<span class="number">10000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,p,k;</div><div class="line"><span class="keyword">int</span> ori[P],tot;</div><div class="line"><span class="keyword">int</span> x,y,z;</div><div class="line"><span class="keyword">int</span> nume=<span class="number">1</span>,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[P&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; q;</div><div class="line"><span class="keyword">int</span> dis[N];</div><div class="line"><span class="comment">//bool vis[N];</span></div><div class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">ok</span><span class="params">(<span class="keyword">int</span> mid)</span></span></div><div class="line">&#123;</div><div class="line">	q.clear();</div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="comment">//memset(vis,0,sizeof(vis));</span></div><div class="line">	dis[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">	q.pb(<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span>(!q.empty())&#123;<span class="comment">//每个值最多入队两次，+1和+0各入队一次 </span></div><div class="line">		<span class="keyword">int</span> x=q.front();</div><div class="line">		q.pop_front();</div><div class="line">		<span class="comment">//if(vis[x])	continue;</span></div><div class="line">		<span class="comment">//vis[x]=1;</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].to;</div><div class="line">			<span class="keyword">if</span>(dis[to]&gt;dis[x]+(e[i].f&gt;mid))&#123;</div><div class="line">				dis[to]=dis[x]+(e[i].f&gt;mid);</div><div class="line">				<span class="keyword">if</span>(e[i].f&lt;=mid)&#123;</div><div class="line">					q.push_front(to);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span>&#123;</div><div class="line">					q.pb(to);</div><div class="line">				&#125;</div><div class="line">			&#125; </div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> dis[n]&lt;=k;</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> l=<span class="number">0</span>,r=tot,mid=<span class="number">0</span>,ans=tot+<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(l&lt;=r)&#123;</div><div class="line">		mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(ok(mid))&#123;</div><div class="line">			ans=mid;</div><div class="line">			r=mid<span class="number">-1</span>; </div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			l=mid+<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(ans&lt;=tot)	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ori[ans]);</div><div class="line">	<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">"-1"</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;p=io;k=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p;++i)&#123;</div><div class="line">		x=io;y=io;z=io;</div><div class="line">		ori[i]=z;</div><div class="line">		add_edge(x,y,z);</div><div class="line">		add_edge(y,x,z);</div><div class="line">	&#125;</div><div class="line">	sort(ori+<span class="number">1</span>,ori+p+<span class="number">1</span>);</div><div class="line">	tot=unique(ori+<span class="number">1</span>,ori+p+<span class="number">1</span>)-ori<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=nume;++i)&#123;</div><div class="line">		e[i].f=lower_bound(ori+<span class="number">1</span>,ori+tot+<span class="number">1</span>,e[i].f)-ori;</div><div class="line">	&#125;</div><div class="line">	MAIN();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>bzoj3073. [Pa2011]Journeys<br>线段树建图后转化成01bfs</p>
<p>线段树建图的步骤：（from lvzelong2014）<br>1、A树每个节点向父亲连边，B树每个节点向儿子连边。边权为零。<br>2、每个B树的叶子节点向对应的A树的叶子节点连边。<br>3、对于a~b连向c~d，在A树上找到a~b对应的区间u1,u2……un，将其连向虚拟节点p1，边权为0<br>4、虚拟节点p1到虚拟节点p2连上边权为1的边<br>5、在B树上找到c~d对应的区间v1,v2……vn从p2连到这些区间，边权为0</p>
<p>3-5的连边为(a,b)-&gt;(c,d)，(c,d)-&gt;(a,b)要再连一次。<br>也可以将p1,p2合并成一个点，然后将3或者5中边权改为1。<br>点或边的数组开小了 就和线段树开小了一样常见的错误<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">500000</span>+<span class="number">8</span>,M=<span class="number">100000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,m,p;</div><div class="line"><span class="keyword">int</span> a,b,c,d;</div><div class="line"><span class="keyword">int</span> numn;</div><div class="line"><span class="keyword">int</span> nume,head[N*<span class="number">8</span>+M*<span class="number">2</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[N*<span class="number">9</span>+M*<span class="number">4</span>*<span class="number">25</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (t&lt;&lt;1)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (t&lt;&lt;1|1)</span></div><div class="line"><span class="keyword">int</span> tr1[N*<span class="number">4</span>],tr2[N*<span class="number">4</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add1</span><span class="params">(<span class="keyword">int</span> t,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> ll,<span class="keyword">int</span> rr)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(ll&lt;=l&amp;&amp;r&lt;=rr)&#123;</div><div class="line">		add_edge(tr1[t],numn,<span class="number">1</span>);</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(ll&lt;=mid)	add1(ls,l,mid,ll,rr);</div><div class="line">	<span class="keyword">if</span>(mid&lt;rr)	add1(rs,mid+<span class="number">1</span>,r,ll,rr);</div><div class="line">&#125;	</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> t,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> ll,<span class="keyword">int</span> rr)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(ll&lt;=l&amp;&amp;r&lt;=rr)&#123;</div><div class="line">		add_edge(numn,tr2[t],<span class="number">0</span>);</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(ll&lt;=mid)	add2(ls,l,mid,ll,rr);</div><div class="line">	<span class="keyword">if</span>(mid&lt;rr)	add2(rs,mid+<span class="number">1</span>,r,ll,rr);</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	++numn;</div><div class="line">	add1(<span class="number">1</span>,<span class="number">1</span>,n,a,b);</div><div class="line">	add2(<span class="number">1</span>,<span class="number">1</span>,n,c,d);</div><div class="line">	++numn;</div><div class="line">	add1(<span class="number">1</span>,<span class="number">1</span>,n,c,d);</div><div class="line">	add2(<span class="number">1</span>,<span class="number">1</span>,n,a,b);</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> be[N],en[N];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">build1</span><span class="params">(<span class="keyword">int</span> t,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">	tr1[t]=++numn;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		be[l]=numn;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	build1(ls,l,mid);</div><div class="line">	build1(rs,mid+<span class="number">1</span>,r);</div><div class="line">	add_edge(tr1[ls],tr1[t],<span class="number">0</span>);</div><div class="line">	add_edge(tr1[rs],tr1[t],<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">build2</span><span class="params">(<span class="keyword">int</span> t,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">	tr2[t]=++numn;</div><div class="line">	<span class="keyword">if</span>(l==r)&#123;</div><div class="line">		en[l]=numn;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	build2(ls,l,mid);</div><div class="line">	build2(rs,mid+<span class="number">1</span>,r);</div><div class="line">	add_edge(tr2[t],tr2[ls],<span class="number">0</span>);</div><div class="line">	add_edge(tr2[t],tr2[rs],<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	build1(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">	build2(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		add_edge(en[i],be[i],<span class="number">0</span>);<span class="comment">//</span></div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> dis[N*<span class="number">8</span>+M*<span class="number">2</span>];</div><div class="line"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; q;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">bfs01</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	dis[be[p]]=<span class="number">0</span>;</div><div class="line">	q.pb(be[p]);</div><div class="line">	<span class="keyword">while</span>(!q.empty())&#123;</div><div class="line">		<span class="keyword">int</span> x=q.front();</div><div class="line">		q.pop_front();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].to;</div><div class="line">			<span class="keyword">if</span>(dis[to]&gt;dis[x]+e[i].f)&#123;</div><div class="line">				dis[to]=dis[x]+e[i].f;</div><div class="line">				<span class="keyword">if</span>(e[i].f)	q.pb(to);</div><div class="line">				<span class="keyword">else</span>	q.push_front(to);</div><div class="line">			&#125;		</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="comment">//if(i!=p)	printf("%d\n",dis[en[i]]);</span></div><div class="line">		<span class="comment">//else	printf("0\n");</span></div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dis[be[i]]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;m=io;p=io;</div><div class="line">	init();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">		a=io;b=io;c=io;d=io;</div><div class="line">		add();</div><div class="line">	&#125;</div><div class="line">	bfs01();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>手写队列：<br>1、普通队列 he=1,ta=0;q[++ta]=x;while(he&lt;=ta){…}<br>2、循环队列 he=1,ta=1;q[ta++]=x;while(he!=ta){…}</p>
<p>luogu3008 [USACO11JAN]道路和飞机Roads and Planes<br>缩点+拓扑+dijk<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">25000</span>+<span class="number">8</span>,M=<span class="number">50000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,r,p,s;</div><div class="line"><span class="keyword">int</span> x,y,z;</div><div class="line"><span class="keyword">int</span> nume=<span class="number">1</span>,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[M*<span class="number">3</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> num,bl[N];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v[N];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	bl[x]=num;</div><div class="line">	v[num].pb(x);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">		<span class="keyword">int</span> to=e[i].to;</div><div class="line">		<span class="keyword">if</span>(!bl[to])&#123;</div><div class="line">			dfs(to);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> ind[N];</div><div class="line"><span class="keyword">int</span> q[N],he,ta;</div><div class="line"><span class="keyword">int</span> dis[N];</div><div class="line"><span class="keyword">bool</span> vis[N];</div><div class="line">priority_queue&lt;PII,<span class="built_in">vector</span>&lt;PII&gt;,greater&lt;PII&gt; &gt; pq; </div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span>(!pq.empty())	pq.pop();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;v[t].size();++i)&#123;</div><div class="line">		pq.push(mp(dis[v[t][i]],v[t][i])); </div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(!pq.empty())&#123;</div><div class="line">		<span class="keyword">int</span> x=pq.top().second;</div><div class="line">		pq.pop();</div><div class="line">		<span class="keyword">if</span>(vis[x])	<span class="keyword">continue</span>;</div><div class="line">		vis[x]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].to;</div><div class="line">			<span class="keyword">if</span>(dis[to]&gt;dis[x]+e[i].f)&#123;</div><div class="line">				dis[to]=dis[x]+e[i].f;</div><div class="line">				<span class="keyword">if</span>(bl[to]==bl[x])&#123;</div><div class="line">					pq.push(mp(dis[to],to));</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(bl[to]!=bl[x])&#123;</div><div class="line">				--ind[bl[to]];</div><div class="line">				<span class="keyword">if</span>(!ind[bl[to]])	q[++ta]=bl[to];</div><div class="line">			&#125;	</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	he=<span class="number">1</span>;ta=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(ind[bl[s]])	q[++ta]=bl[s];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=num;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(!ind[i])	q[++ta]=i;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	dis[s]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(he&lt;=ta)&#123;</div><div class="line">		<span class="keyword">int</span> x=q[he];</div><div class="line">		++he;</div><div class="line">		solve(x);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(dis[i]&gt;<span class="number">5e8</span>)	<span class="built_in">printf</span>(<span class="string">"NO PATH\n"</span>);<span class="comment">//不能用if(dis[i]==0x3f3f3f3f)，因为存在负边权 </span></div><div class="line">		<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dis[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;r=io;p=io;s=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=r;++i)&#123;</div><div class="line">		x=io;y=io;z=io;</div><div class="line">		add_edge(x,y,z);</div><div class="line">		add_edge(y,x,z);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(!bl[i])&#123;</div><div class="line">			++num;</div><div class="line">			dfs(i);</div><div class="line">		&#125;</div><div class="line">	&#125;	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=p;++i)&#123;</div><div class="line">		x=io;y=io;z=io;</div><div class="line">		++ind[bl[y]];</div><div class="line">		add_edge(x,y,z);</div><div class="line">	&#125;</div><div class="line">	MAIN();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="任意两点间最短路"><a href="#任意两点间最短路" class="headerlink" title="任意两点间最短路"></a>任意两点间最短路</h2><p>dijk n^3或nmlogm<br>floyd n^3（还可以用于解决传递闭包）</p>
<h2 id="最大流"><a href="#最大流" class="headerlink" title="最大流"></a>最大流</h2><p>dinic<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10000</span>+<span class="number">8</span>,M=<span class="number">100000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,m,s,t;</div><div class="line"><span class="keyword">int</span> x,y,z;</div><div class="line"><span class="keyword">int</span> nume=<span class="number">1</span>,head[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> to,nxt,f;</div><div class="line">&#125;e[M*<span class="number">2</span>];</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_edge_2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">	e[++nume]=(edge)&#123;y,head[x],z&#125;;head[x]=nume;</div><div class="line">	e[++nume]=(edge)&#123;x,head[y],<span class="number">0</span>&#125;;head[y]=nume;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> cur[N];</div><div class="line"><span class="keyword">int</span> dis[N];</div><div class="line"><span class="keyword">int</span> q[N],he,ta;</div><div class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> low)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(x==t||!low)	<span class="keyword">return</span> low;</div><div class="line">	<span class="keyword">int</span> flow=<span class="number">0</span>,tmp=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> &amp;i=cur[x];i;i=e[i].nxt)&#123;</div><div class="line">		<span class="keyword">int</span> to=e[i].to;</div><div class="line">		<span class="keyword">if</span>(dis[to]==dis[x]+<span class="number">1</span>&amp;&amp;(tmp=dfs(to,min(low,e[i].f))))&#123;</div><div class="line">			flow+=tmp;</div><div class="line">			low-=tmp;</div><div class="line">			e[i].f-=tmp;</div><div class="line">			e[i^<span class="number">1</span>].f+=tmp;</div><div class="line">			<span class="keyword">if</span>(!low)	<span class="keyword">return</span> flow;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(low)	dis[x]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">return</span> flow;</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	he=<span class="number">1</span>;ta=<span class="number">0</span>;</div><div class="line">	q[++ta]=s;</div><div class="line">	dis[s]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(he&lt;=ta)&#123;</div><div class="line">		<span class="keyword">int</span> x=q[he];</div><div class="line">		++he;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">			<span class="keyword">int</span> to=e[i].to;</div><div class="line">			<span class="keyword">if</span>(!dis[to]&amp;&amp;e[i].f)&#123;</div><div class="line">				dis[to]=dis[x]+<span class="number">1</span>;</div><div class="line">				q[++ta]=to;</div><div class="line">				<span class="keyword">if</span>(to==t)	<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dinic</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> maxflow=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(bfs())&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)	cur[i]=head[i];</div><div class="line">		maxflow+=dfs(s,INT_MAX);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,maxflow);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;m=io;s=io;t=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">		x=io;y=io;z=io;</div><div class="line">		add_edge_2(x,y,z);</div><div class="line">	&#125;</div><div class="line">	dinic();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><h3 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10000000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n,qn;</div><div class="line"><span class="keyword">int</span> min_p[N],pri[N],num;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;qn=io;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(!min_p[i])&#123;</div><div class="line">			min_p[i]=i;</div><div class="line">			pri[++num]=i;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=num&amp;&amp;pri[j]&lt;=min_p[i]&amp;&amp;pri[j]&lt;=n/i;++j)&#123;</div><div class="line">			min_p[pri[j]*i]=pri[j];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(qn--)&#123;</div><div class="line">		<span class="keyword">int</span> x=io;</div><div class="line">		<span class="built_in">printf</span>(min_p[x]==x?<span class="string">"Yes\n"</span>:<span class="string">"No\n"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line">LL a,b,mod;</div><div class="line"><span class="function">IL LL <span class="title">ksm</span><span class="params">(LL a,LL b)</span></span></div><div class="line">&#123;</div><div class="line">	LL tmp=<span class="number">1</span>%mod;</div><div class="line">	<span class="keyword">while</span>(b)&#123;</div><div class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>)	tmp=tmp*a%mod;</div><div class="line">		a=a*a%mod;</div><div class="line">		b&gt;&gt;=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	a=io;b=io;mod=io;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld^%lld mod %lld=%lld"</span>,a,b,mod,ksm(a,b));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>luogu2568 GCD<br>所求为sum{prime}sum(2*sum(phi[i])(i=1 to n/prime)-1)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> filein(s) freopen(s,<span class="meta-string">"r"</span>,stdin);</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fileout(s) freopen(s,<span class="meta-string">"w"</span>,stdout);</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> U;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> LLU;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> LD;</div><div class="line"><span class="function">IL LL <span class="title">read</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	LL x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> io read()</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10000000</span>+<span class="number">8</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> phi[N],min_p[N],pri[N],num;</div><div class="line">LL sum[N],ans;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	n=io;</div><div class="line">	phi[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">	sum[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(!min_p[i])&#123;</div><div class="line">			min_p[i]=i;</div><div class="line">			pri[++num]=i;</div><div class="line">			phi[i]=i<span class="number">-1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=num&amp;&amp;pri[j]&lt;=min_p[i]&amp;&amp;pri[j]&lt;=n/i;++j)&#123;</div><div class="line">			min_p[i*pri[j]]=pri[j];</div><div class="line">			phi[i*pri[j]]=phi[i]*(i%pri[j]?pri[j]<span class="number">-1</span>:pri[j]);</div><div class="line">		&#125;</div><div class="line">		sum[i]=sum[i<span class="number">-1</span>]+phi[i];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=num;++i)&#123;</div><div class="line">		ans+=sum[n/pri[i]]*<span class="number">2</span><span class="number">-1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/07/fy的模板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/07/fy的模板/" itemprop="url">未命名</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-07T22:54:53+08:00">
                2019-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>from 23forever</p>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集:"></a>并查集:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">struct Ufs &#123;</div><div class="line">  int n, fa[MAXN + 5], rk[MAXN + 5];</div><div class="line">  void operator() (const int _n) &#123;</div><div class="line">    n = _n;</div><div class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">      fa[i] = i;</div><div class="line">      rk[i] = 1;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  int find(int x) &#123;</div><div class="line">    return fa[x] == x ? fa[x] : fa[x] = find(fa[x]);</div><div class="line">  &#125;</div><div class="line">  void unionSet(int x, int y) &#123;</div><div class="line">    int p = find(x), q = find(y);</div><div class="line">    if (p == q) return;</div><div class="line">    if (rk[p] &lt; rk[q]) &#123;</div><div class="line">      fa[p] = q;</div><div class="line">    &#125; else &#123;</div><div class="line">      if (rk[p] == rk[q]) ++rk[q];</div><div class="line">      fa[q] = p;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;DSU;</div></pre></td></tr></table></figure>
<h3 id="字符串hash"><a href="#字符串hash" class="headerlink" title="字符串hash:"></a>字符串hash:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ULL getHsh(char *s) &#123;</div><div class="line">  int len = strlen(s);</div><div class="line">  ULL ret = 0;</div><div class="line">  for (int i = 0; i &lt; len; ++i) ret = ret * P + s[i];</div><div class="line">  return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">struct BinaryIndexTree &#123;</div><div class="line">  int n, c[MAXN + 5];</div><div class="line">  void operator() (int _n) &#123;</div><div class="line">    n = _n;</div><div class="line">    memset(c, 0, sizeof(c));</div><div class="line">  &#125;</div><div class="line">  int lowbit(int x) &#123;</div><div class="line">    return x &amp; (-x);</div><div class="line">  &#125;</div><div class="line">  void modify(int x, int v) &#123;</div><div class="line">    for (; x &lt;= n; x += lowbit(x)) c[x] += v;</div><div class="line">  &#125;</div><div class="line">  int getSum(int x) &#123;</div><div class="line">    int ret = 0;</div><div class="line">    for (; x; x -= lowbit(x)) ret += c[x];</div><div class="line">    return ret;</div><div class="line">  &#125;</div><div class="line">&#125; Bit;</div></pre></td></tr></table></figure>
<h3 id="ST表："><a href="#ST表：" class="headerlink" title="ST表："></a>ST表：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">void init() &#123;</div><div class="line">  n = read();</div><div class="line">  m = read();</div><div class="line">  for (int i = 1; i &lt;= n; ++i) a[i] = read();</div><div class="line">  for (int i = 1; i &lt;= n; ++i) st[i][0] = a[i];</div><div class="line">  for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j) &#123;</div><div class="line">    for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i) &#123;</div><div class="line">      int a = st[i][j - 1], b = st[i + (1 &lt;&lt; (j - 1))][j - 1];</div><div class="line">      st[i][j] = max(a, b);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">inline int query(int x, int y) &#123;</div><div class="line">  int k = log2(y - x + 1);</div><div class="line">  int a = st[x][k], b = st[y - (1 &lt;&lt; k) + 1][k];</div><div class="line">  return max(a, b);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="KMP："><a href="#KMP：" class="headerlink" title="KMP："></a>KMP：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">void getFail() &#123;</div><div class="line">  fail[0] = 0;</div><div class="line">  fail[1] = 0;</div><div class="line">  for (int i = 1; i &lt;= m; ++i) &#123;</div><div class="line">    int j = fail[i];</div><div class="line">    while (j &amp;&amp; p[i] != p[j]) j = fail[j];</div><div class="line">    fail[i + 1] = p[i] == p[j] ? j + 1 : 0;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">void calc() &#123;</div><div class="line">  int j = 0;</div><div class="line">  for (int i = 0; i &lt;= n; ++i) &#123;</div><div class="line">    while (j &amp;&amp; t[i] != p[j]) j = fail[j];</div><div class="line">    if (t[i] == p[j]) ++j;</div><div class="line">    if (j == m) printf(&quot;%d\n&quot;, i - m + 2);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="manacher："><a href="#manacher：" class="headerlink" title="manacher："></a>manacher：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">int manacher() &#123;</div><div class="line">  int ret = 0;</div><div class="line">  s[n++] = &apos;$&apos;;</div><div class="line">  s[n++] = &apos;#&apos;;</div><div class="line">  for (int i = 0; i &lt; len; ++i) &#123;</div><div class="line">    s[n++] = a[i];</div><div class="line">    s[n++] = &apos;#&apos;;</div><div class="line">  &#125;</div><div class="line">  for (int i = 0; i &lt; n; ++i) &#123;</div><div class="line">    f[i] = i &lt; mx ? min(f[2 * id - i], mx - i) : 1;</div><div class="line">    while (s[i + f[i]] == s[i - f[i]]) ++f[i];</div><div class="line">    if (f[i] + i &gt; mx) &#123;</div><div class="line">      mx = f[i] + i;</div><div class="line">      id = i;</div><div class="line">    &#125;</div><div class="line">    ret = max(ret, f[i]);</div><div class="line">  &#125;</div><div class="line">  return --ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="线段树："><a href="#线段树：" class="headerlink" title="线段树："></a>线段树：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">struct SegmentTree &#123;</div><div class="line">  struct Node &#123;</div><div class="line">    LL delta, mul, sum;</div><div class="line">  &#125;s[MAXN * 4 + 5];</div><div class="line">  SegmentTree() &#123;&#125;</div><div class="line">  #define lson p &lt;&lt; 1</div><div class="line">  #define rson p &lt;&lt; 1 | 1</div><div class="line">  void add(int p, int len, LL v) &#123;</div><div class="line">    s[p].delta = (s[p].delta + v) % mod;</div><div class="line">    s[p].sum = (s[p].sum + v * len) % mod;</div><div class="line">  &#125;</div><div class="line">  void mul(int p, LL v) &#123;</div><div class="line">    s[p].mul = s[p].mul * v % mod;</div><div class="line">    s[p].delta = s[p].delta * v % mod;</div><div class="line">    s[p].sum = s[p].sum * v % mod;</div><div class="line">  &#125;</div><div class="line">  void pd(int p, int len) &#123;</div><div class="line">    if (s[p].mul != 1) &#123;</div><div class="line">      mul(lson, s[p].mul);</div><div class="line">      mul(rson, s[p].mul);</div><div class="line">      s[p].mul = 1;</div><div class="line">    &#125;</div><div class="line">    if (s[p].delta) &#123;</div><div class="line">      add(lson, len - len / 2, s[p].delta);</div><div class="line">      add(rson, len / 2, s[p].delta);</div><div class="line">      s[p].delta = 0;</div><div class="line">    &#125; </div><div class="line">  &#125;</div><div class="line">  void upd(int p) &#123;</div><div class="line">    s[p].sum = (s[lson].sum + s[rson].sum) % mod;</div><div class="line">  &#125;</div><div class="line">  void build(int p, int l, int r) &#123;</div><div class="line">    s[p].mul = 1;</div><div class="line">    if (l == r) &#123;</div><div class="line">      s[p].sum = a[l];</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    build(lson, l, mid);</div><div class="line">    build(rson, mid + 1, r);</div><div class="line">    upd(p);</div><div class="line">  &#125;</div><div class="line">  void modify(int p, int l, int r, int x, int y, LL v) &#123;</div><div class="line">    if (x &lt;= l &amp;&amp; y &gt;= r) &#123;</div><div class="line">      add(p, r - l + 1, v);</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line">    pd(p, r - l + 1);</div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    if (x &lt;= mid) modify(lson, l, mid, x, y, v);</div><div class="line">    if (y &gt; mid) modify(rson, mid + 1, r, x, y, v);</div><div class="line">    upd(p);</div><div class="line">  &#125;</div><div class="line">  void update(int p, int l, int r, int x, int y, LL v) &#123;</div><div class="line">    if (x &lt;= l &amp;&amp; y &gt;= r) &#123;</div><div class="line">      mul(p, v);</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line">    pd(p, r - l + 1);</div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    if (x &lt;= mid) update(lson, l, mid, x, y, v);</div><div class="line">    if (y &gt; mid) update(rson, mid + 1, r, x, y, v);</div><div class="line">    upd(p);</div><div class="line">  &#125;</div><div class="line">  LL query(int p, int l, int r, int x, int y) &#123;</div><div class="line">    if (x &lt;= l &amp;&amp; y &gt;= r) return s[p].sum % mod;</div><div class="line">    pd(p, r - l + 1);</div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    LL ret = 0;</div><div class="line">    if (x &lt;= mid) ret = query(lson, l, mid, x, y);</div><div class="line">    if (y &gt; mid) ret = (ret + query(rson, mid + 1, r, x, y)) % mod;</div><div class="line">    return ret;</div><div class="line">  &#125;</div><div class="line">&#125;Sgt;</div></pre></td></tr></table></figure>
<h3 id="AC自动机："><a href="#AC自动机：" class="headerlink" title="AC自动机："></a>AC自动机：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">struct ACAutomaton &#123;</div><div class="line">  int tot, trie[MAXN + 5][CS], cnt[MAXN + 5];</div><div class="line">  int fail[MAXN + 5], val[MAXN + 5];</div><div class="line">  queue&lt;int&gt; que;</div><div class="line">  ACAutomaton() &#123;&#125;</div><div class="line">  void init() &#123;</div><div class="line">    tot = 0;</div><div class="line">    memset(fail, 0, sizeof(fail));</div><div class="line">    memset(cnt, 0, sizeof(cnt));</div><div class="line">    memset(val, 0, sizeof(val));</div><div class="line">    memset(trie, 0, sizeof(trie));</div><div class="line">  &#125;</div><div class="line">  void insert(char *p, int id) &#123;</div><div class="line">    int m = strlen(p), now = 0;</div><div class="line">    for (int i = 0; i &lt; m; ++i) &#123;</div><div class="line">      int c = p[i] - &apos;a&apos;;</div><div class="line">      if (!trie[now][c]) trie[now][c] = ++tot;</div><div class="line">      now = trie[now][c];</div><div class="line">    &#125;</div><div class="line">    val[now] = id;</div><div class="line">  &#125;</div><div class="line">  void getFail() &#123;</div><div class="line">    for (int i = 0; i &lt; CS; ++i) &#123;</div><div class="line">      int u = trie[0][i];</div><div class="line">      if (u) &#123;</div><div class="line">        fail[u] = 0;</div><div class="line">        que.push(u);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    while (!que.empty()) &#123;</div><div class="line">      int cur = que.front();</div><div class="line">      que.pop();</div><div class="line">      for (int i = 0; i &lt; CS; ++i) &#123;</div><div class="line">        int u = trie[cur][i];</div><div class="line">        if (u) &#123;</div><div class="line">          fail[u] = trie[fail[cur]][i];</div><div class="line">          que.push(u);</div><div class="line">        &#125; else &#123;</div><div class="line">          trie[cur][i] = trie[fail[cur]][i];</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  void query(char *t) &#123;</div><div class="line">    int n = strlen(t), now = 0;</div><div class="line">    for (int i = 0; i &lt; n; ++i) &#123;</div><div class="line">      now = trie[now][t[i] - &apos;a&apos;];</div><div class="line">      int j = now;</div><div class="line">      while (j) &#123;</div><div class="line">        if (val[j]) ++cnt[val[j]];</div><div class="line">        j = fail[j];</div><div class="line">      &#125;</div><div class="line">    &#125; </div><div class="line">    int mx = 0;</div><div class="line">    for (int i = 1; i &lt;= n; ++i) mx = max(mx, cnt[i]);</div><div class="line">    printf(&quot;%d\n&quot;, mx);</div><div class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">      if (cnt[i] == mx) puts(p[i]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;AC;</div></pre></td></tr></table></figure>
<h3 id="线性基："><a href="#线性基：" class="headerlink" title="线性基："></a>线性基：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">struct LinearBasis &#123;</div><div class="line">  LL b[MAXL + 5];</div><div class="line">  void insert(LL x) &#123;</div><div class="line">    for (int i = MAXL; ~i; --i) &#123;</div><div class="line">      if (x &amp; (1LL &lt;&lt; i)) &#123;</div><div class="line">        if (!b[i]) &#123;</div><div class="line">          b[i] = x;</div><div class="line">          return;</div><div class="line">        &#125; else &#123;</div><div class="line">          x ^= b[i];</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  LL query() &#123;</div><div class="line">    LL ret = 0;</div><div class="line">    for (int i = MAXL; ~i; --i) ret = max(ret, (b[i] ^ ret));</div><div class="line">    return ret;</div><div class="line">  &#125;</div><div class="line">&#125;LB;</div></pre></td></tr></table></figure>
<h3 id="左偏树："><a href="#左偏树：" class="headerlink" title="左偏树："></a>左偏树：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">struct Heap &#123;</div><div class="line">  int ls, rs, val, fa, dis;</div><div class="line">&#125;h[MAXN + 5];</div><div class="line">struct LeftistHeap &#123;</div><div class="line">  #define u h[x]</div><div class="line">  #define uls h[u.ls]</div><div class="line">  #define urs h[u.rs]</div><div class="line">  #define o h[y]</div><div class="line">  LeftistHeap() &#123;</div><div class="line">    h[0].val = -1;</div><div class="line">  &#125;</div><div class="line">  int find(int x) &#123;</div><div class="line">    return u.fa ? find(u.fa) : x;</div><div class="line">  &#125;</div><div class="line">  int merge(int x, int y) &#123;</div><div class="line">    if (!x || !y) return x + y;</div><div class="line">    if (u.val &gt; o.val || (u.val == o.val &amp;&amp; x &gt; y)) swap(x, y);</div><div class="line">    u.rs = merge(u.rs, y);</div><div class="line">    urs.fa = x;</div><div class="line">    if (uls.dis &lt; urs.dis) swap(u.ls, u.rs);</div><div class="line">    u.dis = urs.dis + 1;</div><div class="line">    return x;</div><div class="line">  &#125;</div><div class="line">  void delNode(int x) &#123;</div><div class="line">    u.val = -1;</div><div class="line">    uls.fa = 0;</div><div class="line">    urs.fa = 0;</div><div class="line">  &#125;</div><div class="line">  int top(int x) &#123;</div><div class="line">    return u.val;</div><div class="line">  &#125;</div><div class="line">  void del(int x) &#123;</div><div class="line">    delNode(x);</div><div class="line">    merge(u.ls, u.rs);  </div><div class="line">  &#125;</div><div class="line">  void build(int x, int v) &#123;</div><div class="line">    u.val = v;</div><div class="line">  &#125;</div><div class="line">&#125;SH;</div></pre></td></tr></table></figure>
<h3 id="非旋treap"><a href="#非旋treap" class="headerlink" title="非旋treap"></a>非旋treap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line">struct Treap &#123;</div><div class="line">  int ls, rs, sz, key, val;</div><div class="line">  bool rev;</div><div class="line">  Treap() &#123;&#125;</div><div class="line">&#125;t[MAXN + 5];</div><div class="line">struct FhqTreap &#123;</div><div class="line">  int tot;</div><div class="line">  #define u t[x]</div><div class="line">  #define uls t[u.ls]</div><div class="line">  #define urs t[u.rs]</div><div class="line">  #define o t[y]</div><div class="line">  #define ols t[o.ls]</div><div class="line">  #define ors t[o.rs]</div><div class="line">  FhqTreap() &#123;&#125;</div><div class="line">  void createNode(int x) &#123;</div><div class="line">    t[++tot].val = x;</div><div class="line">    t[tot].sz = 1;</div><div class="line">    t[tot].key = rand();</div><div class="line">  &#125;</div><div class="line">  void upd(int x) &#123;</div><div class="line">    u.sz = uls.sz + urs.sz + 1;</div><div class="line">  &#125;</div><div class="line">  void rev(int x) &#123;</div><div class="line">    u.rev ^= 1;</div><div class="line">  &#125;</div><div class="line">  void pd(int x) &#123;</div><div class="line">    if (u.rev) &#123;</div><div class="line">      if (u.ls) rev(u.ls);</div><div class="line">      if (u.rs) rev(u.rs);</div><div class="line">      swap(u.ls, u.rs);</div><div class="line">      u.rev ^= 1;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  pii split(int x, int n) &#123;</div><div class="line">    if (!n) return mp(0, x);</div><div class="line">    pd(x);</div><div class="line">    int m = uls.sz;</div><div class="line">    if (n == m) &#123;</div><div class="line">      int tmp = u.ls;</div><div class="line">      u.ls = 0;</div><div class="line">      upd(x);</div><div class="line">      return mp(tmp, x);</div><div class="line">    &#125; else if (n == m + 1) &#123;</div><div class="line">      int tmp = u.rs;</div><div class="line">      u.rs = 0;</div><div class="line">      upd(x);</div><div class="line">      return mp(x, tmp);</div><div class="line">    &#125; else if (n &lt; m) &#123;</div><div class="line">      pii tmp = split(u.ls, n);</div><div class="line">      u.ls = tmp.se;</div><div class="line">      upd(x);</div><div class="line">      return mp(tmp.fi, x);</div><div class="line">    &#125;</div><div class="line">    pii tmp = split(u.rs, n - m - 1);</div><div class="line">    u.rs = tmp.fi;</div><div class="line">    upd(x);</div><div class="line">    return mp(x, tmp.se);</div><div class="line">  &#125;</div><div class="line">  int merge(int x, int y) &#123;</div><div class="line">    if (!x || !y) return x + y;</div><div class="line">    if (u.key &lt; o.key) &#123;</div><div class="line">      pd(x);</div><div class="line">      u.rs = merge(u.rs, y);</div><div class="line">      upd(x);</div><div class="line">      return x;</div><div class="line">    &#125; else &#123;</div><div class="line">      pd(y);</div><div class="line">      o.ls = merge(x, o.ls);</div><div class="line">      upd(y);</div><div class="line">      return y;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  void insert(int k, int x) &#123;</div><div class="line">    pii tmp = split(rt, k - 1);</div><div class="line">    createNode(x);</div><div class="line">    rt = merge(tmp.fi, merge(tot, tmp.se));</div><div class="line">  &#125;</div><div class="line">  void rever(int x, int y) &#123;</div><div class="line">    pii tmp1 = split(rt, x - 1), tmp2 = split(tmp1.se, y - x + 1);</div><div class="line">    t[tmp2.fi].rev ^= 1;</div><div class="line">    rt = merge(merge(tmp1.fi, tmp2.fi), tmp2.se);</div><div class="line">  &#125;</div><div class="line">  void print(int x) &#123;</div><div class="line">    if (!x) return;</div><div class="line">    pd(x);</div><div class="line">    print(u.ls);</div><div class="line">    printf(&quot;%d &quot;, u.val);</div><div class="line">    print(u.rs);</div><div class="line">  &#125;</div><div class="line">&#125;T;</div></pre></td></tr></table></figure>
<h3 id="主席树："><a href="#主席树：" class="headerlink" title="主席树："></a>主席树：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">struct ChairTree &#123;</div><div class="line">  struct Node &#123;</div><div class="line">    int ls, rs, sz;</div><div class="line">  &#125;s[MAXN * 60 + 5];</div><div class="line">  int tot;</div><div class="line">  #define lson s[p].ls</div><div class="line">  #define rson s[p].rs</div><div class="line">  ChairTree() &#123;&#125; </div><div class="line">  void insert(int &amp;p, int l, int r, int x) &#123;</div><div class="line">    s[++tot] = s[p];</div><div class="line">    p = tot;</div><div class="line">    ++s[p].sz;</div><div class="line">    if (l == r) return; </div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    if (x &lt;= mid) &#123;</div><div class="line">      insert(lson, l, mid, x);</div><div class="line">    &#125; else &#123;</div><div class="line">      insert(rson, mid + 1, r, x);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  int query(int rtl, int rtr, int l, int r, int k) &#123;</div><div class="line">    if (l == r) return l;</div><div class="line">    int sz = s[s[rtr].ls].sz - s[s[rtl].ls].sz;</div><div class="line">    int mid = (l + r) &gt;&gt; 1;</div><div class="line">    if (k &lt;= sz) &#123;</div><div class="line">      return query(s[rtl].ls, s[rtr].ls, l, mid, k);</div><div class="line">    &#125; else &#123;</div><div class="line">      return query(s[rtl].rs, s[rtr].rs, mid + 1, r, k - sz);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;CT;</div></pre></td></tr></table></figure>
<h3 id="LCT："><a href="#LCT：" class="headerlink" title="LCT："></a>LCT：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line">struct LinkCutTree &#123;</div><div class="line">  struct Node &#123;</div><div class="line">    int ch[2], fa;</div><div class="line">    bool rev;</div><div class="line">  &#125;s[MAXN + 5];</div><div class="line">  #define ls ch[0]</div><div class="line">  #define rs ch[1]</div><div class="line">  #define u s[x]</div><div class="line">  #define uls s[u.ls]</div><div class="line">  #define urs s[u.rs]</div><div class="line">  #define ufa s[u.fa]</div><div class="line">  #define o s[y]</div><div class="line">  #define ols s[s[y].ls]</div><div class="line">  #define ors s[s[y].rs]</div><div class="line">  #define ofa s[s[z].fa]</div><div class="line">  #define v s[z]</div><div class="line">  #define vls s[s[z].ls]</div><div class="line">  #define vrs s[s[z].rs]</div><div class="line">  int top, st[MAXN + 5];</div><div class="line">  void pd(int x) &#123;</div><div class="line">    if (u.rev) &#123;</div><div class="line">      u.rev ^= 1;</div><div class="line">      uls.rev ^= 1;</div><div class="line">      urs.rev ^= 1;</div><div class="line">      swap(u.ls, u.rs);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  bool isRoot(int x) &#123;</div><div class="line">    return ufa.ls != x &amp;&amp; ufa.rs != x;</div><div class="line">  &#125; </div><div class="line">  void rotate(int x) &#123;</div><div class="line">    int y = u.fa, z = o.fa, l, r;</div><div class="line">    if (o.ls == x) &#123;</div><div class="line">      l = 0;</div><div class="line">    &#125; else &#123;</div><div class="line">      l = 1;</div><div class="line">    &#125;</div><div class="line">    r = l ^ 1;</div><div class="line">    if (!isRoot(y)) &#123;</div><div class="line">      if (v.ls == y) &#123;</div><div class="line">        v.ls = x;</div><div class="line">      &#125; else &#123;</div><div class="line">        v.rs = x;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    u.fa = z;</div><div class="line">    o.fa = x;</div><div class="line">    s[u.ch[r]].fa = y;</div><div class="line">    o.ch[l] = u.ch[r];</div><div class="line">    u.ch[r] = y;</div><div class="line">  &#125;</div><div class="line">  void splay(int x) &#123;</div><div class="line">    top = 0;</div><div class="line">    st[++top] = x;</div><div class="line">    for (int i = x; !isRoot(i); i = s[i].fa) &#123;</div><div class="line">      st[++top] = s[i].fa;</div><div class="line">    &#125;</div><div class="line">    for (int i = top; i; --i) pd(st[i]);</div><div class="line">    while (!isRoot(x)) &#123;</div><div class="line">      int y = u.fa, z = o.fa;</div><div class="line">      if (!isRoot(y)) &#123;</div><div class="line">        if (v.ls == y ^ o.ls == x) &#123;</div><div class="line">          rotate(x);</div><div class="line">        &#125; else &#123;</div><div class="line">          rotate(y);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      rotate(x);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  void access(int x) &#123;</div><div class="line">    for (int last = 0; x; last = x, x = u.fa) &#123;</div><div class="line">      splay(x);</div><div class="line">      u.rs = last;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  void makeRoot(int x) &#123;</div><div class="line">    access(x);</div><div class="line">    splay(x);</div><div class="line">    u.rev ^= 1;</div><div class="line">  &#125;</div><div class="line">  void link(int x, int y) &#123;</div><div class="line">    makeRoot(x); </div><div class="line">    u.fa = y;</div><div class="line">  &#125;</div><div class="line">&#125;LCT;</div></pre></td></tr></table></figure>
<h3 id="后缀数组："><a href="#后缀数组：" class="headerlink" title="后缀数组："></a>后缀数组：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">bool cmp(int i, int j, int k) &#123;</div><div class="line">  return y[i] == y[j] &amp;&amp; y[i + k] == y[j + k];</div><div class="line">&#125;</div><div class="line">void getSA(int m) &#123;</div><div class="line">  for (int i = 1; i &lt;= m; ++i) b[i] = 0;</div><div class="line">  for (int i = 1; i &lt;= n; ++i) ++b[x[i] = r[i]];</div><div class="line">  for (int i = 1; i &lt;= m; ++i) b[i] += b[i - 1];</div><div class="line">  for (int i = n; i; --i) sa[b[x[i]]--] = i;</div><div class="line">  for (int k = 1; k &lt;= n; k &lt;&lt;= 1) &#123;</div><div class="line">    int p = 0;</div><div class="line">    for (int i = n - k + 1; i &lt;= n; ++i) y[++p] = i;</div><div class="line">    for (int i = 1; i &lt;= n; ++i) if (sa[i] &gt; k) y[++p] = sa[i] - k;</div><div class="line">    for (int i = 1; i &lt;= m; ++i) b[i] = 0;</div><div class="line">    for (int i = 1; i &lt;= n; ++i) ++b[x[y[i]]];</div><div class="line">    for (int i = 1; i &lt;= m; ++i) b[i] += b[i - 1];</div><div class="line">    for (int i = n; i; --i) sa[b[x[y[i]]]--] = y[i];</div><div class="line">    swap(x, y);</div><div class="line">    p = 1, x[sa[1]] = 1;</div><div class="line">    for (int i = 2; i &lt;= n; ++i) x[sa[i]] = cmp(sa[i], sa[i - 1], k) ? p : ++p;</div><div class="line">    m = p;</div><div class="line">    if (m == n) break;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">void getHeight() &#123;</div><div class="line">  int k = 0;</div><div class="line">  for (int i = 1; i &lt;= n; ++i) rk[sa[i]] = i;</div><div class="line">  for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">    if (k) --k;</div><div class="line">    int j = sa[rk[i] - 1];</div><div class="line">    while (r[i + k] == r[j + k]) ++k;</div><div class="line">    height[rk[i]] = k;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机:"></a>后缀自动机:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">struct SuffixAutomaton &#123;</div><div class="line">  int last, tot;</div><div class="line">  int trans[MAXN + 5][CS], link[MAXN + 5], len[MAXN + 5], sz[MAXN + 5];</div><div class="line">  int id[MAXN + 5], pre[MAXN + 5];</div><div class="line">  SuffixAutomaton() : last(1), tot(1) &#123;&#125;</div><div class="line">  void extend(int x) &#123;</div><div class="line">    int c = x - &apos;a&apos;, cur = ++tot, p = last;</div><div class="line">    len[cur] = len[last] + 1;</div><div class="line">    while (p &amp;&amp; !trans[p][c]) &#123;</div><div class="line">      trans[p][c] = cur;</div><div class="line">      p = link[p];</div><div class="line">    &#125;</div><div class="line">    if (!p) &#123;</div><div class="line">      link[cur] = 1;</div><div class="line">    &#125; else &#123;</div><div class="line">      int q = trans[p][c];</div><div class="line">      if (len[p] + 1 == len[q]) &#123;</div><div class="line">        link[cur] = q;</div><div class="line">      &#125; else &#123;</div><div class="line">        int nq = ++tot;</div><div class="line">        len[nq] = len[p] + 1;</div><div class="line">        memcpy(trans[nq], trans[q], sizeof(trans[q]));</div><div class="line">        while (p &amp;&amp; trans[p][c] == q) &#123;</div><div class="line">          trans[p][c] = nq;</div><div class="line">          p = link[p];</div><div class="line">        &#125;</div><div class="line">        link[nq] = link[q];</div><div class="line">        link[q] = nq;</div><div class="line">        link[cur] = nq;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    sz[cur] = 1;</div><div class="line">    last = cur;</div><div class="line">  &#125;</div><div class="line">&#125;SAM;</div></pre></td></tr></table></figure>
<h3 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分:"></a>树链剖分:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">void buildTree(int u) &#123;</div><div class="line">  depth[u] = depth[fa[u]] + 1;</div><div class="line">  sz[u] = 1;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (v != fa[u]) &#123;</div><div class="line">      fa[v] = u;</div><div class="line">      buildTree(v);</div><div class="line">      sz[u] += sz[v];</div><div class="line">      if (sz[son[u]] &lt; sz[v]) son[u] = v;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">void buildChain(int u, int topf) &#123;</div><div class="line">  top[u] = topf;</div><div class="line">  id[u] = ++cnt;</div><div class="line">  mp[id[u]] = u;</div><div class="line">  if (!son[u]) return;</div><div class="line">  buildChain(son[u], topf);</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (v != fa[u] &amp;&amp; v != son[u]) buildChain(v, v);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><h3 id="spfa："><a href="#spfa：" class="headerlink" title="spfa："></a>spfa：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">void spfa(const int s) &#123;</div><div class="line">  memset(d, 0x3f, sizeof(d));</div><div class="line">  que.push(s);</div><div class="line">  d[s] = 0;</div><div class="line">  in_que[s] = true;</div><div class="line">  while (!que.empty()) &#123;</div><div class="line">    int u = que.front();</div><div class="line">    que.pop();</div><div class="line">    in_que[u] = false;</div><div class="line">    for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">      int v = edge[i].to, w = edge[i].w;</div><div class="line">      if (d[u] + w &lt; d[v]) &#123;</div><div class="line">        d[v] = d[u] + w;</div><div class="line">        if (!in_que[v]) &#123;</div><div class="line">          in_que[v] = true;</div><div class="line">          que.push(v);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dijkstra："><a href="#dijkstra：" class="headerlink" title="dijkstra："></a>dijkstra：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">void dijkstra(const int s) &#123;</div><div class="line">  memset(d, 0x3f, sizeof(d));</div><div class="line">  Q.push(Node(s, 0));</div><div class="line">  d[s] = 0;</div><div class="line">  while (!Q.empty()) &#123;</div><div class="line">    int u = Q.top().u;</div><div class="line">    Q.pop();</div><div class="line">    if (vis[u]) continue;</div><div class="line">    for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">      int v = edge[i].to, w = edge[i].w;</div><div class="line">      if (d[u] + w &lt; d[v]) &#123;</div><div class="line">        d[v] = d[u] + w;</div><div class="line">        if (!vis[v]) Q.push(Node(v, d[v]));</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    vis[u] = true;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="prim："><a href="#prim：" class="headerlink" title="prim："></a>prim：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">int prim(const int s) &#123;</div><div class="line">  memset(d, 0x3f, sizeof(d));</div><div class="line">  Q.push(HeapNode(s, 0));</div><div class="line">  d[s] = 0;</div><div class="line">  int cnt = 0, ret = 0;</div><div class="line">  while (!Q.empty()) &#123;</div><div class="line">    int u = Q.top().u;</div><div class="line">    Q.pop();</div><div class="line">    if (vis[u]) continue;</div><div class="line">    ++cnt;</div><div class="line">    ret += d[u];</div><div class="line">    for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">      int v = edge[i].to, w = edge[i].w;</div><div class="line">      if (d[v] &gt; w) &#123;</div><div class="line">        d[v] = w;</div><div class="line">        if (!vis[v]) Q.push(HeapNode(v, w));</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    vis[u] = true;</div><div class="line">  &#125;</div><div class="line">  return cnt &lt; n ? -1 : ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="kruskal："><a href="#kruskal：" class="headerlink" title="kruskal："></a>kruskal：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">int kruskal() &#123;</div><div class="line">  sort(e + 1, e + 1 + m);</div><div class="line">  int ret = 0, cnt = n;</div><div class="line">  for (int i = 1; i &lt;= m; ++i) &#123;</div><div class="line">    int u = e[i].u, v = e[i].v, w = e[i].w;</div><div class="line">    if (DSU.find(u) != DSU.find(v)) &#123;</div><div class="line">      DSU.unionSet(u, v);</div><div class="line">      ret += w;</div><div class="line">      --cnt;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return cnt == 1 ? ret : -1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="倍增求LCA："><a href="#倍增求LCA：" class="headerlink" title="倍增求LCA："></a>倍增求LCA：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">void buildTree(int u, int fa) &#123;</div><div class="line">  an[u][0] = fa;</div><div class="line">  depth[u] = depth[fa] + 1;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (v == fa) continue;</div><div class="line">    buildTree(v, u);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">int LCA(int u, int v) &#123;</div><div class="line">  if (depth[u] &lt; depth[v]) swap(u, v);</div><div class="line">  int k = depth[u] - depth[v];</div><div class="line">  for (int i = 0; (1 &lt;&lt; i) &lt;= k; ++i) &#123;</div><div class="line">    if (k &amp; (1 &lt;&lt; i)) u = an[u][i];</div><div class="line">  &#125;</div><div class="line">  if (u == v) return u;</div><div class="line">  for (int i = MAXL - 1; ~i; --i) &#123;</div><div class="line">    if (an[u][i] != an[v][i]) &#123;</div><div class="line">      u = an[u][i];</div><div class="line">      v = an[v][i];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return an[u][0];</div><div class="line">&#125;</div><div class="line">void init() &#123;</div><div class="line">  //enableFileIO();</div><div class="line">  tot = 0;</div><div class="line">  memset(head, -1, sizeof(head));</div><div class="line">  n = read();</div><div class="line">  m = read();</div><div class="line">  rt = read();</div><div class="line">  for (int i = 1; i &lt; n; ++i) &#123;</div><div class="line">    int u = read(), v = read();</div><div class="line">    add(u, v);</div><div class="line">  &#125;</div><div class="line">  buildTree(rt, 0);</div><div class="line">  for (int i = 1; i &lt; MAXL; ++i) &#123;</div><div class="line">    for (int u = 1; u &lt;= n; ++u) &#123;</div><div class="line">      an[u][i] = an[an[u][i - 1]][i - 1];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="二分图匹配"><a href="#二分图匹配" class="headerlink" title="二分图匹配:"></a>二分图匹配:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">bool hungary(int u) &#123;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (!vis[v]) &#123;</div><div class="line">      vis[v] = true;</div><div class="line">      if (!res[v] || hungary(res[v])) &#123;</div><div class="line">        res[v] = u;</div><div class="line">        return true;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return false;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="求无向图割点："><a href="#求无向图割点：" class="headerlink" title="求无向图割点："></a>求无向图割点：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">void tarjan(int u) &#123;</div><div class="line">  dfn[u] = low[u] = ++ind;</div><div class="line">  int sum = 0;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (!dfn[v]) &#123;</div><div class="line">      tarjan(v);</div><div class="line">      low[u] = min(low[u], low[v]);</div><div class="line">      if (dfn[u] &lt;= low[v]) &#123;</div><div class="line">        ++sum;</div><div class="line">        if (u != rt || sum &gt; 1) is_cut[u] = true;</div><div class="line">      &#125;</div><div class="line">    &#125; else &#123;</div><div class="line">      low[u] = min(low[u], dfn[v]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="spfa判负环："><a href="#spfa判负环：" class="headerlink" title="spfa判负环："></a>spfa判负环：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">bool spfa(const int s) &#123;</div><div class="line">  memset(d, 0x3f, sizeof(d));</div><div class="line">  memset(in_que, false, sizeof(in_que));</div><div class="line">  memset(cnt, 0, sizeof(cnt));</div><div class="line">  que.push(s);</div><div class="line">  in_que[s] = true;</div><div class="line">  d[s] = 0;</div><div class="line">  while (!que.empty()) &#123;</div><div class="line">    int u = que.front();</div><div class="line">    que.pop();</div><div class="line">    in_que[u] = false;</div><div class="line">    for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">      int v = edge[i].to, w = edge[i].w;</div><div class="line">      if (d[u] + w &lt; d[v]) &#123;</div><div class="line">        d[v] = d[u] + w;</div><div class="line">        cnt[v] = cnt[u] + 1;</div><div class="line">        if (cnt[v] &gt;= n) return false;</div><div class="line">        if (!in_que[v]) &#123;</div><div class="line">          que.push(v);</div><div class="line">          in_que[v] = true;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return true;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="tarjan缩点："><a href="#tarjan缩点：" class="headerlink" title="tarjan缩点："></a>tarjan缩点：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">void tarjan(int u) &#123;</div><div class="line">  dfn[u] = low[u] = ++ind;</div><div class="line">  sta.push(u);</div><div class="line">  in_sta[u] = true;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (!dfn[v]) &#123;</div><div class="line">      tarjan(v);</div><div class="line">      low[u] = min(low[u], low[v]);</div><div class="line">    &#125; else if (in_sta[v]) &#123;</div><div class="line">      low[u] = min(low[u], dfn[v]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  if (low[u] == dfn[u]) &#123;</div><div class="line">    int k;</div><div class="line">    sum[++scc_num] = 0;</div><div class="line">    do &#123;</div><div class="line">      k = sta.top();</div><div class="line">      belong[k] = scc_num;</div><div class="line">      sum[scc_num] += val[k];</div><div class="line">      in_sta[k] = false;</div><div class="line">      sta.pop();</div><div class="line">    &#125; while (k != u);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="拓扑排序："><a href="#拓扑排序：" class="headerlink" title="拓扑排序："></a>拓扑排序：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">void topsort() &#123;</div><div class="line">  for (int i = 1; i &lt;= scc_num; ++i) &#123; </div><div class="line">    if (!in[i]) &#123;</div><div class="line">      d[i] = sum[i];</div><div class="line">      que.push(i);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  while (!que.empty()) &#123;</div><div class="line">    int u = que.front();</div><div class="line">    que.pop();</div><div class="line">    for (int i = h[u]; ~i; i = e[i].nxt) &#123;</div><div class="line">      int v = e[i].to;</div><div class="line">      d[v] = max(d[v], d[u] + sum[v]);</div><div class="line">      if (!--in[v]) que.push(v);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dinic求最大流："><a href="#dinic求最大流：" class="headerlink" title="dinic求最大流："></a>dinic求最大流：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">struct Dinic &#123;</div><div class="line">  int level[MAXN + 5], cur[MAXN + 5];</div><div class="line">  queue&lt;int&gt; que;</div><div class="line">  bool makeLevelGraph(const int s, const int t) &#123;</div><div class="line">    memset(level, 0, sizeof(level));</div><div class="line">    while (!que.empty()) que.pop();</div><div class="line">    que.push(s);</div><div class="line">    level[s] = 1;</div><div class="line">    while (!que.empty()) &#123;</div><div class="line">      int u = que.front();</div><div class="line">      que.pop();</div><div class="line">      for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">        int v = edge[i].to, cap = edge[i].cap;</div><div class="line">        if (cap &amp;&amp; !level[v]) &#123;</div><div class="line">          level[v] = level[u] + 1;</div><div class="line">          que.push(v);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      if (level[t]) return true;</div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">  &#125;</div><div class="line">  int findAugPath(int u, int t, int flow) &#123;</div><div class="line">    if (u == t || !flow) return flow;</div><div class="line">    int used = 0;</div><div class="line">    for (int &amp;i = cur[u]; ~i &amp;&amp; used &lt; flow; i = edge[i].nxt) &#123;</div><div class="line">      int v = edge[i].to, &amp;cap = edge[i].cap, &amp;rcap = edge[i ^ 1].cap;</div><div class="line">      if (cap &amp;&amp; level[v] == level[u] + 1) &#123;</div><div class="line">        int d = findAugPath(v, t, min(flow - used, cap));</div><div class="line">        if (d) &#123;</div><div class="line">          used += d;</div><div class="line">          rcap += d;</div><div class="line">          cap -= d;</div><div class="line">          return d;</div><div class="line">        &#125; else &#123;</div><div class="line">          level[v] = -INF;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    return 0;</div><div class="line">  &#125;</div><div class="line">  int operator()(const int s, const int t) &#123;</div><div class="line">    int ret = 0, f;</div><div class="line">    while (makeLevelGraph(s, t)) &#123;</div><div class="line">      memcpy(cur, head, sizeof(head));</div><div class="line">      while (f = findAugPath(s, t, INF)) ret += f;</div><div class="line">    &#125;</div><div class="line">    return ret;</div><div class="line">  &#125;</div><div class="line">&#125;dinic;</div></pre></td></tr></table></figure>
<h3 id="最小费用最大流："><a href="#最小费用最大流：" class="headerlink" title="最小费用最大流："></a>最小费用最大流：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">struct Mfmc &#123;</div><div class="line">  int d[MAXN + 5], pre[MAXN + 5], id[MAXN + 5];</div><div class="line">  queue&lt;int&gt; que;</div><div class="line">  bool in_que[MAXN + 5];</div><div class="line">  bool spfa(const int s, const int t) &#123;</div><div class="line">    memset(d, 0x3f, sizeof(d));</div><div class="line">    memset(pre, -1, sizeof(pre));</div><div class="line">    que.push(s);</div><div class="line">    d[s] = 0;</div><div class="line">    pre[s] = 0;</div><div class="line">    in_que[s] = true;</div><div class="line">    while (!que.empty()) &#123;</div><div class="line">      int u = que.front();</div><div class="line">      que.pop();</div><div class="line">      in_que[u] = false;</div><div class="line">      for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">        int v = edge[i].to, cap = edge[i].cap, cost = edge[i].cost;</div><div class="line">        if (cap &amp;&amp; d[u] + cost &lt; d[v]) &#123;</div><div class="line">          d[v] = d[u] + cost;</div><div class="line">          pre[v] = u;</div><div class="line">          id[v] = i;</div><div class="line">          if (!in_que[v]) &#123;</div><div class="line">            in_que[v] = true;</div><div class="line">            que.push(v);</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    return ~pre[t];</div><div class="line">  &#125;</div><div class="line">  pii operator()(const int s, const int t) &#123;</div><div class="line">    int min_cost = 0, max_flow = 0;</div><div class="line">    while (spfa(s, t)) &#123;</div><div class="line">      int f = INF;</div><div class="line">      for (int u = t; u != s; u = pre[u]) f = min(f, edge[id[u]].cap);</div><div class="line">      for (int u = t; u != s; u = pre[u]) &#123;</div><div class="line">        edge[id[u]].cap -= f;</div><div class="line">        edge[id[u] ^ 1].cap += f;</div><div class="line">      &#125;</div><div class="line">      max_flow += f;</div><div class="line">      min_cost += f * d[t];</div><div class="line">    &#125;</div><div class="line">    return mp(max_flow, min_cost);</div><div class="line">  &#125;</div><div class="line">&#125;mfmc;</div></pre></td></tr></table></figure>
<h3 id="2-sat："><a href="#2-sat：" class="headerlink" title="2-sat："></a>2-sat：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">stack&lt;int&gt; sta;</div><div class="line">bool in_sta[MAXN + 5];</div><div class="line">int dfn[MAXN + 5], low[MAXN + 5], idx, scc_num, belong[MAXN + 5];</div><div class="line">void tarjan(int u) &#123;</div><div class="line">  dfn[u] = low[u] = ++idx;</div><div class="line">  sta.push(u);</div><div class="line">  in_sta[u] = true;</div><div class="line">  for (int i = head[u]; ~i; i = edge[i].nxt) &#123;</div><div class="line">    int v = edge[i].to;</div><div class="line">    if (!dfn[v]) &#123;</div><div class="line">      tarjan(v);</div><div class="line">      low[u] = min(low[u], low[v]);</div><div class="line">    &#125; else if (in_sta[v]) &#123;</div><div class="line">      low[u] = min(low[u], dfn[v]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  if (dfn[u] == low[u]) &#123;</div><div class="line">    int k;</div><div class="line">    ++scc_num;</div><div class="line">    do &#123;</div><div class="line">      k = sta.top();</div><div class="line">      belong[k] = scc_num;</div><div class="line">      in_sta[k] = false;</div><div class="line">      sta.pop();</div><div class="line">    &#125; while (k != u);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">int n, m;</div><div class="line">void init() &#123;</div><div class="line">  //enableFileIO();</div><div class="line">  tot = 0;</div><div class="line">  memset(head, -1, sizeof(head));</div><div class="line">  n = read();</div><div class="line">  m = read();</div><div class="line">  for (int i = 1; i &lt;= m; ++i) &#123;</div><div class="line">    int u = read(), a = read(), v = read(), b = read();</div><div class="line">    if (a &amp;&amp; b) &#123;</div><div class="line">      add(u + n, v);</div><div class="line">      add(v + n, u);</div><div class="line">    &#125; else if (!a &amp;&amp; b) &#123;</div><div class="line">      add(v + n, u + n);</div><div class="line">      add(u, v);</div><div class="line">    &#125; else if (a &amp;&amp; !b) &#123;</div><div class="line">      add(u + n, v + n);</div><div class="line">      add(v, u);</div><div class="line">    &#125; else &#123;</div><div class="line">      add(u, v + n);</div><div class="line">      add(v, u + n);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">int main() &#123;</div><div class="line">  init();</div><div class="line">  for (int i = 1; i &lt;= 2 * n; ++i) &#123;</div><div class="line">    if (!dfn[i]) tarjan(i);</div><div class="line">  &#125;</div><div class="line">  for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">    if (belong[i] == belong[i + n]) &#123;</div><div class="line">      puts(&quot;IMPOSSIBLE&quot;);</div><div class="line">      return 0;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  puts(&quot;POSSIBLE&quot;);</div><div class="line">  for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">    printf(&quot;%d &quot;, belong[i] &lt; belong[i + n]);</div><div class="line">  &#125;</div><div class="line">  printf(&quot;\n&quot;);</div><div class="line">  return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><h3 id="快速幂："><a href="#快速幂：" class="headerlink" title="快速幂："></a>快速幂：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">LL fastPow(LL b, LL p, LL m) &#123;</div><div class="line">  LL ret = 1;</div><div class="line">  b %= m;</div><div class="line">  while (p) &#123;</div><div class="line">    if (p &amp; 1) ret = ret % m * b % m;</div><div class="line">    b = b % m * b % m;</div><div class="line">    p &gt;&gt;= 1;</div><div class="line">  &#125;</div><div class="line">  return ret % m;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="埃氏筛："><a href="#埃氏筛：" class="headerlink" title="埃氏筛："></a>埃氏筛：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">for (int i = 2; i &lt;= n; ++i) &#123;</div><div class="line">    if (c[i]) continue;</div><div class="line">    for (int j = i; j &lt;= n / i; ++j) &#123;</div><div class="line">      c[i * j] = true;</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h3 id="求1-n的phi值"><a href="#求1-n的phi值" class="headerlink" title="求1-n的phi值"></a>求1-n的phi值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">for (int i = 2; i &lt;= n; ++i) phi[i] = i;</div><div class="line">for (int i = 2; i &lt;= n; ++i) &#123;</div><div class="line">  if (phi[i] == i) &#123;</div><div class="line">    for (int j = i; j &lt;= n; j += i) &#123;</div><div class="line">      phi[j] = phi[j] / i * (i - 1);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="求1-n的所有约数"><a href="#求1-n的所有约数" class="headerlink" title="求1-n的所有约数"></a>求1-n的所有约数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">  for (int j = 1; j &lt;= n / i; ++j) &#123;</div><div class="line">    fac[i * j].push_back(i);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="矩阵快速幂："><a href="#矩阵快速幂：" class="headerlink" title="矩阵快速幂："></a>矩阵快速幂：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">struct Matrix &#123;</div><div class="line">  LL a[MAXN + 5][MAXN + 5];</div><div class="line">  int n, m;</div><div class="line">  Matrix() &#123;&#125;</div><div class="line">  Matrix(int _n, int _m) : n(_n), m(_m) &#123;</div><div class="line">    memset(a, 0, sizeof(a));</div><div class="line">  &#125;</div><div class="line">  void operator() (int _n, int _m) &#123;</div><div class="line">    n = _n;</div><div class="line">    m = _m;</div><div class="line">    memset(a, 0, sizeof(a));</div><div class="line">  &#125;</div><div class="line">  void init() &#123;</div><div class="line">    memset(a, 0, sizeof(a));</div><div class="line">    for (int i = 1; i &lt;= n; ++i) a[i][i] = 1;</div><div class="line">  &#125;</div><div class="line">  Matrix operator * (const Matrix &amp;mat) &#123;</div><div class="line">    Matrix ret(n, m);</div><div class="line">    for (int i = 1; i &lt;= n; ++i) &#123;</div><div class="line">      for (int j = 1; j &lt;= m; ++j) &#123;</div><div class="line">        for (int k = 1; k &lt;= mat.n; ++k) &#123;</div><div class="line">          ret.a[i][j] = (ret.a[i][j] + a[i][k] * mat.a[k][j]) % MOD;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    return ret;</div><div class="line">  &#125;</div><div class="line">&#125;a;</div><div class="line">Matrix fastPow(Matrix mat, LL k) &#123;</div><div class="line">  Matrix ret(mat.n, mat.m);</div><div class="line">  ret.init();</div><div class="line">  while (k) &#123;</div><div class="line">    if (k &amp; 1) ret = ret * mat;</div><div class="line">    mat = mat * mat;</div><div class="line">    k &gt;&gt;= 1;</div><div class="line">  &#125;</div><div class="line">  return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="线性求逆元："><a href="#线性求逆元：" class="headerlink" title="线性求逆元："></a>线性求逆元：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">int main() &#123;</div><div class="line">  init();</div><div class="line">  ans[1] = 1;</div><div class="line">  for (int i = 2; i &lt;= n; ++i) ans[i] = 1LL * (p - p / i) * ans[p % i] % p;</div><div class="line">  for (int i = 1; i &lt;= n; ++i) printf(&quot;%d\n&quot;, ans[i]);</div><div class="line">  return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="快速乘："><a href="#快速乘：" class="headerlink" title="快速乘："></a>快速乘：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">LL fastMul(LL b, LL p, LL m) &#123;</div><div class="line">  LL ret = 0;</div><div class="line">  while (p) &#123;</div><div class="line">    if (p &amp; 1) ret = (ret + b) % m;</div><div class="line">    b = (b + b) % m;</div><div class="line">    p &gt;&gt;= 1;</div><div class="line">  &#125;</div><div class="line">  return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="拓展欧几里得："><a href="#拓展欧几里得：" class="headerlink" title="拓展欧几里得："></a>拓展欧几里得：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">LL exgcd(LL a, LL b, LL &amp;x, LL &amp;y) &#123;</div><div class="line">  if (!b) &#123;</div><div class="line">    x = 1, y = 0;</div><div class="line">    return a;</div><div class="line">  &#125;</div><div class="line">  LL g = exgcd(b, a % b, x, y), tmp = x;</div><div class="line">  x = y, y = tmp - a / b * y;</div><div class="line">  return g;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="拓展中国剩余定理："><a href="#拓展中国剩余定理：" class="headerlink" title="拓展中国剩余定理："></a>拓展中国剩余定理：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">LL excrt(LL *a, LL *m) &#123;</div><div class="line">  LL ret = m[1], lcm = a[1], x, y;</div><div class="line">  for (int i = 2; i &lt;= n; ++i) &#123;</div><div class="line">    m[i] = (m[i] - ret % a[i] + a[i]) % a[i];</div><div class="line">    LL g = exgcd(lcm, a[i], x, y);</div><div class="line">    if (m[i] % g) return -1;</div><div class="line">    LL k = fastMul(x, m[i] / g, a[i]); //x * m[i] / g % a[i];</div><div class="line">    ret += k * lcm;</div><div class="line">    lcm = lcm / g * a[i];</div><div class="line">    ret = (ret % lcm + lcm) % lcm;</div><div class="line">  &#125;</div><div class="line">  return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/05/bzoj1913 [Apio2010]signaling 信号覆盖/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/05/bzoj1913 [Apio2010]signaling 信号覆盖/" itemprop="url">bzoj1913 [Apio2010]signaling 信号覆盖</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-05T22:31:34+08:00">
                2019-04-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>算任意四点的贡献<br>① 如果这四个点构成的是凹四边形：<br>四种圆中除了在圆上的三点之外，只有一种圆会包含剩余一个点，所以一个凹四边形对答案贡献为1。<br>② 构成的是凸多边形：<br>四种圆中有两种圆会包含剩余的一个点（被包含的点分别是对角和大于180°的两个点），因此一个凸四边形对答案的贡献为2。<br>s=凹四边形个数+2*凸四边形个数，答案为$3+\frac {s}{ n\choose 3}$</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/05/bzoj1912 [Apio2010]patrol 巡逻/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/05/bzoj1912 [Apio2010]patrol 巡逻/" itemprop="url">bzoj1912 [Apio2010]patrol 巡逻</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-05T22:02:40+08:00">
                2019-04-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>加一条边形成一个环，环上的边可以少走一次<br>k=1时直接找直径<br>k=2时先找一条直径，连一条边，此时如果再要经过这个环上的边，答案要加2，所以将之前找的边置为-1再找一次直径（简单证明：1)如果答案包含一条直径：注意到第一次找直径的时候可能存在多条。假如存在一条直径与第一次选的直径没有边交集，第二次就会选择那一条；假如所有直径都与它有边交集，注意到有交集的直径都是相同的（不管是点交集还是边交集），不然存在更长的链，所以随便选的那一条没有问题。2)答案不包含直径。这是不可能的。如果选的两条都不经过直径，则将一条换成直径更优；如果选的有一条经过直径，则换成直径更优；如果两条都经过直径，可以换成一条直径加一个环，答案不会更劣。）<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/04/05/bzoj1912 [Apio2010]patrol 巡逻/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/11/【学习笔记】随机化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/11/【学习笔记】随机化/" itemprop="url">【学习笔记】随机化</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-11T15:02:09+08:00">
                2019-02-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>cf上用random_shuffle挂了<br>看来随机化还是要好好了解一下</p>
<p><random>头文件从c++11起</random></p>
<p>time相关：<br>std::time<br>定义于头文件 <ctime><br>std::time_t time( std::time_t* arg );</ctime></p>
<p>CLOCKS_PER_SEC<br>定义于头文件 <ctime></ctime></p>
<p>#define CLOCKS_PER_SEC /<em>implementation defined</em>/<br>展开成 std::clock_t 类型表达式，值等于每秒 std::clock() 所返回的时钟计次数（不必是编译时常量）。</p>
<p>std::clock<br>定义于头文件 <ctime><br>std::clock_t clock();<br>返回进程从关联到程序执行的实现定义时期开始，所用的粗略处理器时间。为转换结果为秒，可将它除以 CLOCKS_PER_SEC 。</ctime></p>
<p>ftime()<br>定义于头文件 <sys timeb.h=""><br>函数定义：void ftime(struct timeb *tp);<br>函数说明：ftime()将目前日期由tp所指的结构体返回。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timeb</span>&#123;</span></div><div class="line">    <span class="keyword">time_t</span> time;   <span class="comment">/* 为1970-01-01至今的秒数*/</span></div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> millitm; <span class="comment">/* 千分之一秒即毫秒 */</span></div><div class="line">    <span class="keyword">short</span> timezone;  <span class="comment">/* 为目前时区和Greenwich相差的时间，单位为分钟 */</span></div><div class="line">    <span class="keyword">short</span> dstflag;   <span class="comment">/* 为日光节约时间的修正状态，如果为非0代表启用日光节约时间修正 */</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></sys></p>
<p>c&amp;c++03的随机化：<br>std::srand<br>定义于头文件 <cstdlib><br>void srand( unsigned seed );<br>注意：<br>通常来说，应该只播种一次随机数生成器，在程序开始出，任何到 rand() 的调用前。不应重复播种，或每次冀愿生成新一批随机数时重播种。<br>标准实践是使用以 time(0) 为种子调用的结果。然而 time() 返回 time_t 值，而不保证 time_t 是整数类型。尽管实践中，主流实现都定义 time_t 为整数类型，且此亦为 POSIX 所要求。<br>1.srand(time(0)); //time();<br>2.srand(tim.time*1000+tim.millitm); //ftime();</cstdlib></p>
<p>RAND_MAX（保证此值至少为 32767）<br>win下32767，linux下2147483647</p>
<p>std::rand<br>定义于头文件 <cstdlib><br>int rand();<br>返回 0 与 RAND_MAX （包含 0 与 RAND_MAX ）的随机数。<br>推荐用 C++11 的随机数生成设施替换 rand() 。 (C++11 起)</cstdlib></p>
<p>random_shuffle<br>定义于头文件 <algorithm><br>基于rand()<br>类似的实现：</algorithm></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">IL <span class="keyword">void</span> <span class="title">random_shuffl</span><span class="params">(T first,T last)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> n=last-first;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">		swap(*(first+i),*(first+rand()%(i+<span class="number">1</span>)));	</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于rand()有可能太小，移动的偏差可能很小（cf上的测试，3e6的数列，每个值平均移动2%，期望移动是1/3）<br>自己手写random_shuffle:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">ra</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">return</span> (rand()&lt;&lt;<span class="number">15</span>)+rand();	</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">IL <span class="keyword">void</span> <span class="title">random_shuffl</span><span class="params">(T first,T last)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> n=last-first;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">		swap(*(first+i),*(first+ra()%(i+<span class="number">1</span>)));	</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>c++11起可以使用mt19937作为更优质的随机数生成器替代rand()<br>定义于头文件 <random><br>mt19937:32位梅森缠绕器<br>mt19937_64:64位梅森缠绕器<br>成员函数：</random></p>
<p>构造与播种：</p>
<ul>
<li>(构造函数)：构造引擎 (公开成员函数)</li>
<li>seed：设置引擎的当前状态 (公开成员函数)</li>
</ul>
<p>生成：</p>
<ul>
<li>operator()：令引擎状态向前并返回生成值 (公开成员函数)</li>
</ul>
<p>特征：</p>
<ul>
<li>min[静态]：获取输出范围中的最小可能值 (公开静态成员函数)</li>
<li>max[静态]：获取输出范围中的最大可能值 (公开静态成员函数)</li>
</ul>
<p>例：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mt19937 mt;</div><div class="line">mt.seed(<span class="comment">/*随机数种子*/</span>); <span class="comment">// 或者在定义时mt19937 mt(/*随机数种子*/);</span></div><div class="line">mt.min();mt.max();      <span class="comment">// 0 2^32-1</span></div><div class="line">mt();                   <span class="comment">// 返回[min(),max()]中的随机数</span></div><div class="line"><span class="comment">//mt19937_64就是[0,2^64-1]的随机数生成器</span></div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/02/【学习笔记】数论相关/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="littleming">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小明的阁楼">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/02/【学习笔记】数论相关/" itemprop="url">【学习笔记】数论相关</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-02T23:30:18+08:00">
                2019-02-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>退役了就学学数论吧<br>退役后的第一场cf（话说已经半年没打cf了<br>536f(1106)题是矩乘+bsgs</p>
<p>发现我什么都不会<br>先贴一些基础的模块吧</p>
<p>求原根：<br>一个数m有原根的充要条件是m=1,2,4,p^e,2p^e, 其中p为奇素数， e为正整数。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">primitive_rt</span><span class="params">(<span class="keyword">int</span> p)</span><span class="comment">//p是奇素数 </span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> phi=p<span class="number">-1</span>;<span class="comment">//p不是素数就改成求phi</span></div><div class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; fact;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i*i&lt;=phi;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(phi%i==<span class="number">0</span>)&#123;</div><div class="line">			fact.pb(i);</div><div class="line">			<span class="keyword">while</span>(p%i==<span class="number">0</span>)	phi/=i;	</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(phi&gt;<span class="number">1</span>)	fact.pb(phi);</div><div class="line">	phi=p<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;p;++i)&#123;</div><div class="line">		<span class="keyword">bool</span> ok=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;fact.size();++j)&#123;</div><div class="line">			<span class="keyword">if</span>(ksm(i,phi/fact[j],p)==<span class="number">1</span>)&#123;</div><div class="line">				ok=<span class="number">0</span>;<span class="keyword">break</span>;	</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(ok)	<span class="keyword">return</span> i;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>求（一个）离散对数：<br>//求所有的把map<int,int>改成map<int,vector>即可<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span><span class="comment">//calc x which a^x=b(mod p), (a,p)=1</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; ma;</div><div class="line">	ma.clear();</div><div class="line">	<span class="keyword">int</span> t=round(<span class="built_in">sqrt</span>(p))+<span class="number">1</span>;</div><div class="line">	<span class="comment">//多求一些x不影响答案 </span></div><div class="line">	<span class="keyword">int</span> tmp=b;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=t;++i)&#123;</div><div class="line">		ma[tmp]=i;</div><div class="line">		tmp=LL(tmp)*a%p;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> c=ksm(a,t,p);</div><div class="line">	tmp=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=t;++i)&#123;</div><div class="line">		<span class="keyword">int</span> j=ma.find(tmp)==ma.end()?<span class="number">-1</span>:ma[tmp];</div><div class="line">		<span class="keyword">if</span>(j&gt;=<span class="number">0</span>&amp;&amp;i*t-j&gt;=<span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">return</span> i*t-j;	</div><div class="line">		&#125;</div><div class="line">		tmp=LL(tmp)*c%p;	</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></int,vector></int,int></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">exbsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span><span class="comment">//a和p不一定互质</span></span></div><div class="line">&#123;</div><div class="line">	a%=p;b%=p;</div><div class="line">	<span class="keyword">if</span>(b==<span class="number">1</span>)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> v=<span class="number">1</span>,d,cnt=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>((d=gcd(a,p))&gt;<span class="number">1</span>)&#123;</div><div class="line">		<span class="keyword">if</span>(b%d)	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">		b/=d;p/=d;++cnt;</div><div class="line">		v=LL(v)*a/d%p;</div><div class="line">		<span class="keyword">if</span>(v==b)	<span class="keyword">return</span> cnt;	<span class="comment">//去掉也是对的 </span></div><div class="line">	&#125;</div><div class="line">	<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; ma;</div><div class="line">	ma.clear();</div><div class="line">	<span class="keyword">int</span> t=round(<span class="built_in">sqrt</span>(p))+<span class="number">1</span>;</div><div class="line">	<span class="comment">//多求一些x不影响答案 </span></div><div class="line">	<span class="keyword">int</span> tmp=b;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=t;++i)&#123;</div><div class="line">		ma[tmp]=i;</div><div class="line">		tmp=LL(tmp)*a%p;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> c=ksm(a,t,p);</div><div class="line">	tmp=v;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=t;++i)&#123;</div><div class="line">		<span class="keyword">int</span> j=ma.find(tmp)==ma.end()?<span class="number">-1</span>:ma[tmp];</div><div class="line">		<span class="keyword">if</span>(j&gt;=<span class="number">0</span>&amp;&amp;i*t-j&gt;=<span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">return</span> i*t-j+cnt;	</div><div class="line">		&#125;</div><div class="line">		tmp=LL(tmp)*c%p;	</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>求（所有）离散底数：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> ans[<span class="number">100008</span>],ta;</div><div class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span><span class="comment">//calc all x which x^a=b(mod p)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> g=primitive_rt(p);</div><div class="line">	a=ksm(g,a,p); </div><div class="line">	<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; ma;</div><div class="line">	ma.clear();</div><div class="line">	<span class="keyword">int</span> t=round(<span class="built_in">sqrt</span>(p))/<span class="number">2</span>+<span class="number">1</span>;<span class="comment">//调块大小过 </span></div><div class="line">	<span class="keyword">int</span> tmp=b;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=t;++i)&#123;</div><div class="line">		ma[tmp].pb(i);</div><div class="line">		tmp=LL(tmp)*a%p;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> c=ksm(a,t,p);</div><div class="line">	tmp=<span class="number">1</span>;</div><div class="line">	ta=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> up=p/t+<span class="number">1</span>;<span class="comment">//调过块大小要改up </span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=up;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(ma.find(tmp)!=ma.end())&#123;</div><div class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v=ma[tmp];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;v.size();++j)&#123;</div><div class="line">				<span class="keyword">int</span> x=i*t-v[j];</div><div class="line">				<span class="keyword">if</span>(x&gt;=<span class="number">0</span>&amp;&amp;x&lt;p<span class="number">-1</span>)&#123;</div><div class="line">					ans[++ta]=x;	</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		tmp=LL(tmp)*c%p;	</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(ta==<span class="number">0</span>)&#123;</div><div class="line">		<span class="built_in">puts</span>(<span class="string">"No Solution"</span>);	</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=ta;++i)&#123;</div><div class="line">		ans[i]=ksm(g,ans[i],p);	</div><div class="line">	&#125;</div><div class="line">	sort(ans+<span class="number">1</span>,ans+ta+<span class="number">1</span>);</div><div class="line">	ta=unique(ans+<span class="number">1</span>,ans+ta+<span class="number">1</span>)-ans<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=ta;++i)&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[i]);	</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="littleming" />
          <p class="site-author-name" itemprop="name">littleming</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">112</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">57</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        ﻿<div class="copyright" >
  
  &copy;  2002 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">littleming</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">  Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (search_path.endsWith("json")) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
